(this["webpackJsonpfree-roam"]=this["webpackJsonpfree-roam"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(27),i=n.n(a),l=n(3),o=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,118)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))},s=n(14),d=(n(57),n(6)),u=(n(58),n(9)),b=(n(59),n(29)),f=n(5),j=n(20),h=n(7),p=n(15),x=n.n(p),v=n(40),k=n.n(v);x.a.extend(k.a);var O="MMMM Do, YYYY",I="YYYY-MM-DD",g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=void 0===t?Object(h.c)(8):t,r=e.parentId,c=void 0===r?null:r,a=e.text,i=e.childrenIds,l=void 0===i?[]:i,o=e.created,s=void 0===o?Date.now():o,d=e.dailyNote,u=void 0===d?null:d,b=arguments.length>1?arguments[1]:void 0,f=!c;if(f&&!u){var j=x()(a,O);j.isValid()&&(u=j.format(I))}if(u)n=u;else if(n in b)for(;n in b;)n=Object(h.c)(8);return{id:n,parentId:c,text:a,childrenIds:l,created:s,updated:null,dailyNote:u}},m=function e(t,n){return t.parentId?e(n[t.parentId],n):t},y=function(e,t){var n=m(e,t);return e.parentId===n.id&&n.childrenIds[0]===e.id},N=function(e,t){if(null===e.parentId)return null;var n=t[e.parentId],r=n.childrenIds.indexOf(e.id);return r===n.childrenIds.length-1?null:t[n.childrenIds[r+1]]},w=function e(t,n){return t.childrenIds.length?e(n[t.childrenIds.slice(-1)],n):t},S=function(e,t){if(!e.parentId||y(e,t))return null;var n=function(e,t){if(null===e.parentId)return null;var n=t[e.parentId],r=n.childrenIds.indexOf(e.id);return r<1?null:t[n.childrenIds[r-1]]}(e,t);return n?n.childrenIds.length?w(n,t):n:t[e.parentId]},B=function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null===t.parentId)return null;if(r&&t.childrenIds.length)return n[t.childrenIds[0]];var c=N(t,n);return c||e(n[t.parentId],n,r=!1)},C=function e(t,n){var r=t.childrenIds,c=Object(j.a)(t,["childrenIds"]);return r.length?Object(f.a)(Object(f.a)({},c),{},{children:r.map((function(t){var r=n[t];return e(r,n)}))}):c},P=function e(t,n){var r;return t.childrenIds.length?(r=[t.id]).concat.apply(r,Object(b.a)(t.childrenIds.map((function(t){return e(n[t],n)})))):t.id},M=n(106),R=n(107),T=(n(60),Object(h.b)({name:"viewPane",initialState:{views:[{type:"page",blockId:"efgh"}]},reducers:{setViewPaneState:function(e,t){var n=t.payload;if(n&&"views"in n)return n},pushView:function(e,t){var n=t.payload,r=n.type,c=n.blockId;e.views.find((function(e){return e.type===r&&e.blockId===c}))||e.views.unshift(t.payload)},popView:function(e,t){var n=t.payload,r=n.type,c=n.blockId;e.views=e.views.filter((function(e){return"all"!==r&&e.type!==r||e.blockId!==c}))}}})),_=T.actions,F=_.setViewPaneState,X=_.pushView,D=_.popView,q=T.reducer,L=n(1),A=function(e){var t=e.blockId,n=e.isPage,r=void 0===n||n,c=e.children,a=e.noStyling,i=e.afterClick,o=Object(j.a)(e,["blockId","isPage","children","noStyling","afterClick"]),d=Object(l.b)(),u="/page/".concat(t);return Object(L.jsx)(s.b,Object(f.a)(Object(f.a)({to:u,onClick:function(e){e.shiftKey&&(e.preventDefault(),d(X({type:r?"page":"block",blockId:t}))),i&&i(),e.stopPropagation()},className:"block-link".concat(a?" block-link--no-styling":"")},o),{},{children:c}))},E=function(e){var t=e.block,n=e.isMain,c=Object(r.useState)(!0),a=Object(u.a)(c,2),i=a[0],o=a[1],s=Object(r.useState)(!1),d=Object(u.a)(s,2),b=d[0],f=d[1],j=Object(r.useState)(null),h=Object(u.a)(j,2),p=h[0],x=h[1],v=Object(l.c)((function(e){return e.links})),k=Object(l.c)((function(e){return e.blocks})),O=v.to[t.id];return Object(L.jsxs)("div",{children:[null===t.parentId&&O&&O.length>0&&n&&Object(L.jsxs)("div",{className:"references references--linked",children:[Object(L.jsxs)("span",{className:"references__toggle no-select",onClick:function(){return o((function(e){return!e}))},children:[i?Object(L.jsx)(M.a,{color:"white"}):Object(L.jsx)(R.a,{color:"white"}),Object(L.jsxs)("b",{children:[O.length," Linked References"]})]}),i&&function(){if(!t.parentId&&O&&O.length)return O.map((function(e){if(!(e in k))return null;var t=k[e],r=m(t,k);return Object(L.jsxs)("div",{children:[Object(L.jsx)(A,{blockId:r.id,children:Object(L.jsx)("h5",{children:r.text})}),Object(L.jsx)("div",{className:"reference-container",children:Object(L.jsx)(ye,{blockId:e,isRoot:!1,isMain:n,fold:!0,showBreadcrumbs:!0})})]},e)}))}()]}),null===t.parentId&&n&&Object(L.jsxs)("div",{className:"references references--unlinked",children:[Object(L.jsxs)("span",{className:"references__toggle no-select",onClick:function(e){b?f(!1):(f(!0),x(function(e){var t=new RegExp("(?<![\\[\\w])".concat(e,"(?![\\[\\w]+)"),"gi");return Object.values(k).filter((function(e){return e.parentId&&t.test(e.text)}))}(t.text)))},children:[b?Object(L.jsx)(M.a,{color:"white"}):Object(L.jsx)(R.a,{color:"white"}),Object(L.jsxs)("b",{children:[p&&p.length?p.length:""," Unlinked References"]})]}),b&&function(){if(!t.parentId&&b)return p.length?p.map((function(e){var t=m(e,k);return Object(L.jsxs)("div",{children:[Object(L.jsx)(A,{blockId:t.id,children:Object(L.jsx)("h5",{children:t.text})}),Object(L.jsx)("div",{className:"reference-container",children:Object(L.jsx)(ye,{blockId:e.id,isRoot:!1,isMain:n,fold:!0,showBreadcrumbs:!0})})]},e.id)})):Object(L.jsx)("p",{children:"No unlinked references"})}()]})]})},Y=(n(65),n(46)),H=n(24),z=n.n(H),V=n(19),W=function(e,t){var n,r=e.matchAll(/\[\[([^\]]*(?:\]\])?)\]\]/gm),c=!1,a=null,i=Object(V.a)(r);try{for(i.s();!(n=i.n()).done;){var l=n.value,o=l[0],s=l.index,d=s+o.length-2;if(c=s+2<=t&&t<=d)return{startBracketIndex:s,endBracketIndex:d,caretInBrackets:c,textInBrackets:a=l[1]}}}catch(u){i.e(u)}finally{i.f()}return{startBracketIndex:-1,endBracketIndex:-1,caretInBrackets:c,textInBrackets:a}},K={abcd:{id:"abcd",parentId:null,text:"Hello World",childrenIds:["ijkl","mnop"]},efgh:{id:"efgh",parentId:null,text:"Lorem ipsum",childrenIds:["qrst"]},ijkl:{id:"ijkl",parentId:"abcd",text:"Normal *italics* **bold** ***bold italics***",childrenIds:[]},mnop:{id:"mnop",parentId:"abcd",text:"Link to [[Lorem ipsum]]",childrenIds:["uvwx","a1"]},qrst:{id:"qrst",parentId:"efgh",text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",childrenIds:[]},uvwx:{id:"uvwx",parentId:"mnop",text:"I'm a third layer block",childrenIds:["a2"]},a1:{id:"a1",parentId:"mnop",text:"I'm another third layer block",childrenIds:[]},a2:{id:"a2",parentId:"uvwx",text:"I'm a fourth layer block",childrenIds:[]},"2021-02-17":{id:"2021-02-17",parentId:null,text:"February 17th, 2021",childrenIds:["a4"],created:1613546102e3,updated:null,dailyNote:"2021-02-17"},a4:{id:"a4",parentId:"a3",text:"Click here to edit",childrenIds:[]},plXnqf7B:{id:"plXnqf7B",parentId:"welcome",text:"Welcome to Free-Roam!",childrenIds:[],created:1613962018019,updated:1613962047962,dailyNote:null},welcome:{id:"welcome",parentId:null,text:"Welcome",childrenIds:["plXnqf7B","0NOhIzxB","H-O00XW0","64SNNX17"],created:1613962018016,updated:null,dailyNote:null},"0NOhIzxB":{id:"0NOhIzxB",parentId:"welcome",text:"Take a look around; you can check out:",childrenIds:["pKs_vxuk","ANZddpXT","NMb4Yf1z"],created:1613962048878,updated:1613962057083,dailyNote:null},pKs_vxuk:{id:"pKs_vxuk",parentId:"0NOhIzxB",text:"[Daily Notes](#/daily-notes) (like a journal)",childrenIds:[],created:1613962057397,updated:1613962069453,dailyNote:null},ANZddpXT:{id:"ANZddpXT",parentId:"0NOhIzxB",text:"All of the [current pages](#/all-pages)",childrenIds:[],created:1613962070989,updated:1613962076848,dailyNote:null},NMb4Yf1z:{id:"NMb4Yf1z",parentId:"0NOhIzxB",text:"A sample page: [[Hello World]]",childrenIds:["nbGfXXqe"],created:1613962077493,updated:1613962081636,dailyNote:null},nbGfXXqe:{id:"nbGfXXqe",parentId:"NMb4Yf1z",text:"Shift+click to open in side bar",childrenIds:[],created:1613962082245,updated:1613962090754,dailyNote:null},"H-O00XW0":{id:"H-O00XW0",parentId:"welcome",text:"Be sure to save your work if you wish to persist it",childrenIds:["mPiN8jkq"],created:1613962091917,updated:1613962107536,dailyNote:null},mPiN8jkq:{id:"mPiN8jkq",parentId:"H-O00XW0",text:"Save/load buttons in top left",childrenIds:[],created:1613962107877,updated:1613962114571,dailyNote:null},"64SNNX17":{id:"64SNNX17",parentId:"welcome",text:"Enjoy! Check out [the repo](https://github.com/cofinley/free-roam) to learn more and/or contribute!",childrenIds:[],created:1613962115053,updated:1613962120478,dailyNote:null}},J=Object(h.b)({name:"blocks",initialState:K,reducers:{setBlocksState:function(e,t){var n=t.payload;if(n&&"object"===typeof n)return n},addBlock:function(e,t){var n=t.payload;if(n.parentId){e[n.parentId].childrenIds.push(n.id)}else{var r=g({parentId:n.id,text:"Click here to edit"},e);n.childrenIds.push(r.id),e[r.id]=r}e[n.id]=n},removeBlock:function(e,t){var n=t.payload.blockId,r=e[n];if(!r.childrenIds.length){var c=e[r.parentId];e[r.parentId].childrenIds=c.childrenIds.filter((function(e){return e!==n})),delete e[n]}},removePage:function(e,t){var n=t.payload.blockId,r=e[n];if(r.childrenIds.length){var c,a=Object(V.a)(r.childrenIds);try{for(a.s();!(c=a.n()).done;){var i=c.value;J.caseReducers.removePage(e,{payload:{blockId:i}})}}catch(l){a.e(l)}finally{a.f()}delete e[n]}else delete e[n]},changeParent:function(e,t){var n=t.payload,r=n.blockId,c=n.parentId;e[r].parentId=c,e[c].childrenIds.push(r)},updateBlock:function(e,t){var n=t.payload,r=n.blockId,c=n.parentId,a=n.childrenIds,i=n.text,l=e[r];if(l){l.parentId=c||l.parentId,l.childrenIds=a||l.childrenIds;var o=l.text;l.text="string"===typeof i?i:o,l.updated=Date.now(),e[r]=l,l.parentId||J.caseReducers.changeTitle(e,{payload:{currentTitle:o,newTitle:i}})}},changeTitle:function(e,t){var n=t.payload,r=n.currentTitle,c=n.newTitle,a=new RegExp("\\[\\[".concat(r,"\\]\\]"),"g");Object.values(e).map((function(t){return a.test(t.text)&&(e[t.id].text=t.text.replace("[[".concat(r,"]]"),"[[".concat(c,"]]"))),!0}))},repositionBlock:function(e,t){var n=t.payload,r=n.blockId,c=n.direction,a=e[r],i=e[a.parentId],l=i.childrenIds.indexOf(a.id);if("forward"===c){if(l>0){var o=e[i.childrenIds[l-1]];i.childrenIds.splice(l,1),o.childrenIds.push(r),a.parentId=o.id}}else{var s=e[a.parentId];if(s.parentId){var d=e[s.parentId],u=d.childrenIds.indexOf(s.id);-1!==u&&(s.childrenIds.splice(l,1),d.childrenIds.splice(u+1,0,r),a.parentId=d.id)}}},makeSibling:function(e,t){var n=t.payload,r=n.firstSiblingBlockId,c=n.secondSiblingBlockId,a=e[r];if(a.parentId){var i=e[c];if(i.parentId){var l=e[i.parentId],o=l.childrenIds.indexOf(c);l.childrenIds.splice(o,1)}var s=e[a.parentId],d=s.childrenIds.indexOf(r);e[s.id].childrenIds.splice(d+1,0,c)}}}}),Q=J.actions,G=Q.setBlocksState,U=(Q.getBlockByText,Q.addBlock),Z=Q.removeBlock,$=Q.removePage,ee=Q.updateBlock,te=Q.repositionBlock,ne=Q.makeSibling,re=J.reducer,ce=Object(h.b)({name:"editor",initialState:{focusedBlock:{blockId:"",isMain:!0,caretPos:0}},reducers:{setEditorState:function(e,t){var n=t.payload;if(n&&"focusedBlock"in n)return n},updateFocusedBlock:function(e,t){e.focusedBlock=t.payload}}}),ae=ce.actions,ie=ae.setEditorState,le=ae.updateFocusedBlock,oe=ce.reducer,se=(n(66),function(e){var t=e.query,n=e.useLinks,r=e.onResultClick,a=e.onlyPages,i=e.allowCreation,o=e.onCreateClick,s=Object(l.c)((function(e){return e.blocks})),d=[];if(t&&t.length){var u=Object.values(s).filter((function(e){return(!a||null===e.parentId)&&-1!==e.text.indexOf(t)}));if(d=u.map((function(e){return n?Object(L.jsx)(A,{blockId:e.id,className:"search-result",afterClick:r,children:e.text},e.id):Object(L.jsx)("li",{className:"search-result",onMouseDown:r.bind(null,e),children:e.text},e.id)})),i){if(!(void 0!==u.find((function(e){return e.text===t})))){var b=Object(L.jsxs)("li",{className:"search-result",onClick:o,children:[Object(L.jsx)("b",{children:"Create"})," ",t]},"new-page-".concat(t));d.splice(0,0,b)}}else if(!d.length){var f=Object(L.jsx)("li",{className:"search-result",children:Object(L.jsx)("span",{children:"Search for a page"})},"default-suggestion");d.splice(0,0,f)}}return Object(L.jsx)(c.a.Fragment,{children:d.length>0&&Object(L.jsx)("div",{className:"search-results",children:Object(L.jsx)("ul",{className:"list-group list-group-flush",children:d})})})}),de=function(e){var t=e.block,n=e.isMain,c=e.isTitle,a=e.cursorCaret,i=e.setCursorCaret,o=e.onRender,s=Object(l.b)(),d=Object(r.useRef)(null),b=Object(r.useState)(!1),f=Object(u.a)(b,2),j=f[0],h=f[1],p=Object(l.c)((function(e){return e.editor.focusedBlock})),x=Object(l.c)((function(e){return e.blocks})),v=Object(r.useState)(!1),k=Object(u.a)(v,2),O=k[0],I=k[1],m=function(e){e.preventDefault(),e.shiftKey?s(te({blockId:t.id,direction:"backward"})):s(te({blockId:t.id,direction:"forward"})),s(le({blockId:t.id,isMain:n,caretPos:e.target.selectionStart}))},N=function(e){e.preventDefault();var r="";if(e.target.selectionStart!==e.target.value.length){var c=e.target.selectionStart;r=t.text.substring(c);var a=t.text.substring(0,c);s(ee({blockId:t.id,text:a})),e.target.value=a}var i=g({text:r,parentId:t.parentId},x);s(U(i)),s(ne({firstSiblingBlockId:t.id,secondSiblingBlockId:i.id})),s(le({blockId:i.id,isMain:n,caretPos:0}))},w=function(e){e.preventDefault();var t=e.target.selectionStart,n=e.target.value,r=n.charAt(t-1);if(e.target.value=n.substring(0,t)+"[]"+n.substring(t,n.length),e.target.selectionStart=t+1,e.target.selectionEnd=t+1,"["===r&&!j)return h(!0),void I("");h(!1)},C=function(e){if(0===d.current.selectionStart&&!t.childrenIds.length){e.preventDefault();var r=S(t,x);if(r){var c=r.text.length;s(ee({blockId:r.id,text:r.text+t.text})),s(Z({blockId:t.id})),s(le({blockId:r.id,isMain:n,caretPos:c}))}}},P=function(e){var r="ArrowUp"===e.key,c=window.getComputedStyle(e.target),a=parseInt(c.getPropertyValue("line-height")),i=e.target.selectionStart,l=function(e,t){return z()(e,e.selectionStart).top<=t}(e.target,a),o=function(e,t){var n=z()(e,e.selectionStart).top;return e.offsetHeight<=n+t}(e.target,a);if(l&&r&&!y(t,x)){var d=S(t,x);d&&(s(le({blockId:d.id,caretPos:i,isMain:n})),e.preventDefault())}else if(o&&!r){var u=B(t,x);u&&(s(le({blockId:u.id,caretPos:i,isMain:n})),e.preventDefault())}},M=p.blockId&&p.blockId===t.id&&p.isMain===n&&!isNaN(p.caretPos);M&&d.current&&d.current.focus();return Object(L.jsxs)("div",{className:"block__autocomplete-container",children:[Object(L.jsx)(Y.a,{ref:d,className:"block-text block-text--edit".concat(c?" block-text--title":""),autoFocus:!0,onFocus:function(e){M?(e.target.selectionStart=p.caretPos,e.target.selectionEnd=p.caretPos):null!==a.offsetX&&function(e){if(e){for(var t=["*","_"],n=e.value,r=1e4,c=0,l=[],o=0;o<=e.value.length;o++){var s=e.value.charAt(o);if(t.includes(s)){var d=e.value.split("");d.splice(o,1),e.value=d.join(""),l.push(o),o--}var u=z()(e,o),b=u.left,f=u.top,j=Math.sqrt(Math.pow(b-a.offsetX,2)+Math.pow(f-a.offsetY,2));j<r&&(r=j,c=o)}e.value=n;var h=c;l.length&&l[0]<=h&&(h+=l.filter((function(e){return e<=c})).length),e.selectionStart=h,e.selectionEnd=h,i({offsetX:null,offsetY:null,width:null})}}(e.target)},onKeyDown:function(e){"Tab"===e.key?m(e):"Enter"!==e.key||e.shiftKey?"["===e.key?w(e):"Backspace"===e.key?C(e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||P(e):N(e)},onChange:function(e){j||t.text===e.target.value||s(ee({blockId:t.id,text:e.target.value}))},onKeyUp:function(e){var t=e.target.selectionStart,n=W(e.target.value,t);n.caretInBrackets?(h(!0),I(n.textInBrackets)):h(!1)},onBlur:function(e){var n;n=e.target.value,t.text!==n&&s(ee({blockId:t.id,text:n})),o()},defaultValue:t.text}),j&&Object(L.jsx)(se,{query:O,onlyPages:!0,useLinks:!1,onResultClick:function(e,n){n.preventDefault();var r=e.text,c=d.current.value,a=d.current.selectionStart,i=W(c,a),l=c.substring(0,i.startBracketIndex+2)+r+c.substring(i.endBracketIndex);d.current.value=l,h(!1),I(null),s(ee({blockId:t.id,text:l}))}})]})},ue=n(42),be=n(43),fe=n.n(be),je=Object(h.b)({name:"links",initialState:{to:{efgh:["mnop"]},from:{mnop:["efgh"]}},reducers:{setLinksState:function(e,t){var n=t.payload;if(n&&"to"in n&&"from"in n)return n},setLinks:function(e,t){var n=t.payload,r=n.sourceBlockId,c=n.linkedBlockIds;if(r&&c&&c.length){var a;if(r in e.from){if(JSON.stringify(e.from[r].sort())===JSON.stringify(c.sort()))return;var i=e.from[r].filter((function(e){return!c.includes(e)}));i.length&&i.map((function(t){return e.to[t]=e.to[t].filter((function(e){return r!==e})),!0})),a=c.filter((function(t){return!e.from[r].includes(t)}))}else a=c;a.length&&a.map((function(t){return t in e.to||(e.to[t]=[]),e.to[t].push(r),!0})),e.from[r]=c}},removeBlockLinks:function(e,t){var n=t.payload.blockId,r=e.from[n];je.caseReducers.setLinks(e,{payload:{sourceBlockId:n,linkedBlockIds:[]}}),r&&r.map((function(t){return e.to[t]=e.to[t].filter((function(e){return e!==n})),!0})),delete e.from[n]}}}),he=je.actions,pe=he.setLinksState,xe=he.setLinks,ve=he.removeBlockLinks,ke=je.reducer,Oe=function(e){var t=e.block,n=e.isTitle,r=e.onEdit,a=Object(l.b)(),i=Object(l.c)((function(e){return e.blocks})),o=Object(l.c)((function(e){return e.links.from})),s=function(e){var n=new Set,r=fe()(e,/\[\[([^[\]]*)\]\]/g,(function(e,t){var r=u(e);return n.add(r.id),Object(L.jsx)(A,{blockId:r.id,children:r.text},"".concat(e,"-").concat(t))})),c=Array.from(n),i=t.id in o;return c.length&&(i&&d(new Set(c),new Set(o[t.id]))||a(xe({sourceBlockId:t.id,linkedBlockIds:c}))),r},d=function(e,t){if(e.size!==t.size)return!1;var n,r=Object(V.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;if(!t.has(c))return!1}}catch(a){r.e(a)}finally{r.f()}return!0},u=function(e){var t=Object.values(i).filter((function(e){return!e.parentId})).find((function(t){return t.text===e}));if(t)return t;var n=g({text:e},i);return a(U(n)),n};return Object(L.jsx)("span",{className:"block-text".concat(n?" block-text--title":""),onClick:r,children:function(){var e=t.text;return s(e).map((function(e){if("string"===typeof e){var t=Object(ue.a)(e);return c.a.cloneElement(t,{key:e})}return e}))}()})},Ie=function(e){var t=e.block,n=e.isMain,c=e.isTitle,a=Object(l.c)((function(e){return e.editor.focusedBlock})),i=Object(r.useState)(a.isMain===n&&a.blockId===t.id),o=Object(u.a)(i,2),s=o[0],d=o[1],b=Object(r.useState)({offsetX:null,offsetY:null,width:null}),f=Object(u.a)(b,2),j=f[0],h=f[1];return a.blockId&&a.blockId===t.id&&a.isMain===n&&!isNaN(a.caretPos)&&!s&&d(!0),Object(L.jsx)("div",{className:"block",children:s?Object(L.jsx)(de,{block:t,isMain:n,isTitle:c,cursorCaret:j,setCursorCaret:h,onRender:function(e){d(!1)}}):Object(L.jsx)(Oe,{block:t,isTitle:c,onEdit:function(e){if(!t.dailyNote){var n=e.clientX,r=e.clientY,c=n-e.currentTarget.offsetLeft,a=r-e.currentTarget.offsetTop,i=e.currentTarget.offsetWidth;h({offsetX:c,offsetY:a,width:i}),d(!0)}}})})},ge=function(e){var t=e.block,n=Object(l.c)((function(e){return e.blocks}));return Object(L.jsx)("div",{className:"breadcrumbs text-muted",children:function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)return r.reverse();var c=n[t],a=Object(L.jsx)(A,{blockId:t,isPage:null===c.parentId,noStyling:!0,children:c.text},t);return e(c.parentId,r.concat(a))}(t.parentId)})},me=(n(87),function(e){var t=e.block,n=e.hasChildren,r=e.foldBlock,c=e.setFoldBlock;return Object(L.jsxs)("div",{className:"block-actions-container",children:[Object(L.jsxs)("span",{className:"block-actions block-actions--toggle".concat(n?"":" hidden"),children:[r&&Object(L.jsx)(R.a,{color:"white",onClick:function(){return c(!1)}}),!r&&Object(L.jsx)(M.a,{color:"white",onClick:function(){return c(!0)}})]}),Object(L.jsx)(A,{blockId:t.id,noStyling:!0,isPage:!1,children:Object(L.jsx)("div",{className:"block-actions block-actions--bullet".concat(r&&n?" fold":""),children:Object(L.jsx)("span",{children:"\u2022"})})})]})}),ye=function e(t){var n=t.blockId,c=t.isRoot,a=t.showBreadcrumbs,i=void 0!==a&&a,o=t.isMain,s=t.fold,d=void 0!==s&&s,b=Object(l.c)((function(e){return e.blocks}))[n],f=Object(r.useState)(d),j=Object(u.a)(f,2),h=j[0],p=j[1],x=Object(r.useState)(!1),v=Object(u.a)(x,2),k=v[0],O=v[1];if(Object(r.useEffect)((function(){p(d)}),[d]),!b)return Object(L.jsx)("h1",{className:"text-light",children:"Page not found"});var I=null===b.parentId,g=I&&c,m=b.childrenIds.map((function(t){return Object(L.jsx)(e,{isRoot:!1,isMain:o,blockId:t,fold:k},t)}));return Object(L.jsxs)("div",{className:"editor ".concat(c?"editor--root":"editor--child").concat(I?" editor--page":""),children:[(i||c&&!I)&&Object(L.jsx)(ge,{block:b}),Object(L.jsxs)("div",{className:"d-flex",children:[!g&&Object(L.jsx)(me,{block:b,foldBlock:h,setFoldBlock:p,hasChildren:m.length>0}),Object(L.jsx)(Ie,{block:b,isTitle:g,isMain:o})]}),!h&&m.length>0&&Object(L.jsxs)("div",{className:"editor__children",children:[null!==b.parentId&&Object(L.jsx)("div",{className:"editor__children__thread-line",onClick:function(){return O(!k)}}),Object(L.jsx)("div",{className:"editor__children__container",children:m})]}),c&&Object(L.jsx)(E,{block:b,isMain:o},b.id)]})},Ne=n(108),we=n(109),Se=n(110),Be=(n(88),Object(h.b)({name:"navbar",initialState:{searchQuery:""},reducers:{setNavbarState:function(e,t){var n=t.payload;if(n&&"searchQuery"in n)return n},updateSearchQuery:function(e,t){var n=t.payload.query;e.searchQuery=n}}})),Ce=Be.actions,Pe=Ce.setNavbarState,Me=Ce.updateSearchQuery,Re=(Ce.removeShortcut,Be.reducer),Te=Object(h.b)({name:"filePane",initialState:{favoriteBlockIds:["abcd","efgh"]},reducers:{setFilePaneState:function(e,t){var n=t.payload;if(n&&"favoriteBlockIds"in n)return n},toggleShortcut:function(e,t){var n=t.payload.blockId;e.favoriteBlockIds.indexOf(n)>-1?e.favoriteBlockIds=e.favoriteBlockIds.filter((function(e){return n!==e})):e.favoriteBlockIds.push(n)},removeShortcut:function(e,t){var n=t.payload.blockId;e.favoriteBlockIds=e.favoriteBlockIds.filter((function(e){return e!==n}))}}}),_e=Te.actions,Fe=_e.setFilePaneState,Xe=_e.toggleShortcut,De=_e.removeShortcut,qe=Te.reducer,Le=function(e){var t,n=e.blockId,r=Object(l.b)(),c=Object(l.c)((function(e){return e.navbar.searchQuery})),a=Object(l.c)((function(e){return e.blocks})),i=Object(l.c)((function(e){return e.filePane.favoriteBlockIds})),o=Object(d.f)(),s=function e(t){return t.parentId?e(a[t.parentId]):t.id};if(n){var u=a[n];if(u){var b=s(u);t=i.includes(b)}}var f;void 0!==t&&(f=t?Object(L.jsx)(Ne.a,{color:"white"}):Object(L.jsx)(we.a,{color:"white"}));var j=function(e){r(Me({query:""}))};return Object(L.jsxs)("div",{className:"navbar",children:[Object(L.jsxs)("div",{className:"search-container",children:[Object(L.jsxs)("div",{className:"input-group",children:[Object(L.jsx)("div",{className:"input-group-prepend",children:Object(L.jsx)("span",{className:"input-group-text bg-dark text-dark border-secondary",children:Object(L.jsx)(Se.a,{color:"white"})})}),Object(L.jsx)("input",{type:"text",className:"form-control bg-dark text-light border-secondary",placeholder:"Find or Create Page",onChange:function(e){return r(Me({query:e.target.value}))},value:c})]}),Object(L.jsx)(se,{query:c,useLinks:!0,onResultClick:j,allowCreation:!0,onCreateClick:function(){var e=g({text:c},a);r(U(e)),j(),o.push("/page/".concat(e.id))}})]}),void 0!==f&&Object(L.jsx)("button",{className:"btn btn--toggle-favorite",onClick:function(e){var t=s(a[n]);r(Xe({blockId:t}))},children:f})]})},Ae=n(28),Ee=n.n(Ae);n(89);x.a.extend(Ee.a);var Ye=function(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e.blocks})),r=Object.values(n).filter((function(e){return!!e.dailyNote})).sort((function(e,t){return e.dailyNote.localeCompare(t.dailyNote)})).reverse(),c=x()(),a=c.format(O),i=r.find((function(e){return e.text===a}));i||(i=g({text:a,dailyNote:c.format(I)},n),t(U(i)));var o=r.map((function(e){return Object(L.jsx)(ye,{blockId:e.id,isMain:!0,isRoot:!0},e.id)}));return Object(L.jsx)("div",{className:"daily-notes",children:o})},He=n(30),ze=n(111),Ve=n(112),We=n(113),Ke=n(114),Je=n(44),Qe=n(45),Ge=n.n(Qe),Ue=(n(100),function(e){var t=new Ge.a;e.map((function(e){var n=e.content,r=e.fileName;return t.file(r||"free-roam.json",JSON.stringify(n)),!0})),t.generateAsync({type:"blob"}).then((function(e){Object(Je.saveAs)(e,"Free-Roam-Export-".concat(Date.now()))}))}),Ze=function(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e}));return Object(L.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(L.jsx)("label",{className:"load-button-input mr-3",children:Object(L.jsx)("input",{type:"file",className:"btn btn-secondary",accept:".json",onChange:function(e){e.preventDefault();var n=new FileReader;n.onload=function(e){var n=JSON.parse(e.target.result);"blocks"in n&&t(G(n.blocks)),"editor"in n&&t(ie(n.editor)),"filePane"in n&&t(Fe(n.filePane)),"links"in n&&t(pe(n.links)),"navbar"in n&&t(Pe(n.navbar)),"viewPane"in n&&t(F(n.viewPane))},n.readAsText(e.target.files[0])}})}),Object(L.jsx)("button",{className:"btn btn-secondary",onClick:function(){return Ue([{content:n,fileName:"free-roam.json"}])},children:"Save"})]})},$e=c.a.forwardRef((function(e,t){var n=e.indeterminate,r=Object(j.a)(e,["indeterminate"]),a=c.a.useRef(),i=t||a;return c.a.useEffect((function(){i.current.indeterminate=n}),[i,n]),Object(L.jsx)(L.Fragment,{children:Object(L.jsx)("input",Object(f.a)({type:"checkbox",ref:i},r))})})),et=function(e){var t=e.columns,n=e.data,r=Object(l.b)(),c=Object(l.c)((function(e){return e.blocks})),a=Object(l.c)((function(e){return e.links.to})),i=function(e){e.length&&e.map((function(e){return e.original.blockId})).map((function(e){var t=c[e];return P(c[e],c).map((function(e){return r(D({type:"all",blockId:e})),(a[e]||[]).map((function(e){var n=c[e],a=new RegExp("\\[\\[(".concat(t.text,")\\]\\]"),"g"),i=n.text.replace(a,"$1");return r(ee({blockId:e,text:i})),!0})),r(ve({blockId:e})),!0})),r(De({blockId:e})),r($({blockId:e})),!0}))},o=Object(He.useTable)({columns:t,data:n},He.useSortBy,He.useRowSelect,(function(e){e.visibleColumns.push((function(e){return[{id:"selection",Header:function(e){var t=e.getToggleAllRowsSelectedProps;return Object(L.jsx)("div",{children:Object(L.jsx)($e,Object(f.a)({},t()))})},Cell:function(e){var t=e.row;return Object(L.jsx)("div",{children:Object(L.jsx)($e,Object(f.a)({},t.getToggleRowSelectedProps()))})}}].concat(Object(b.a)(e))}))})),s=o.getTableProps,d=o.getTableBodyProps,u=o.headerGroups,j=o.rows,h=o.prepareRow,p=o.selectedFlatRows,x=o.state.selectedRowIds;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)("div",{className:"all-pages__toolbar",children:[Object(L.jsx)(ze.a,{onClick:function(){return i(p)},className:"mr-3 all-pages__button".concat(Object.keys(x).length?" active":"")}),Object(L.jsx)(Ve.a,{onClick:function(){return function(e){if(e.length){var t=e.map((function(e){return e.original.blockId})).map((function(e){var t=c[e];return{content:C(t,c),fileName:"".concat(t.text,".json")}}));Ue(t)}}(p)},className:"all-pages__button".concat(Object.keys(x).length?" active":"")}),Object(L.jsx)("div",{className:"flex-grow-1"})]}),Object(L.jsxs)("table",Object(f.a)(Object(f.a)({className:"table table-dark"},s()),{},{children:[Object(L.jsx)("thead",{className:"thead-dark",children:u.map((function(e){return Object(L.jsx)("tr",Object(f.a)(Object(f.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(L.jsxs)("th",Object(f.a)(Object(f.a)({scope:"col"},e.getHeaderProps([{className:e.className},e.getSortByToggleProps()])),{},{children:[e.render("Header"),Object(L.jsx)("span",{children:e.isSorted?e.isSortedDesc?Object(L.jsx)(We.a,{color:"white"}):Object(L.jsx)(Ke.a,{color:"white"}):""})]}))}))}))}))}),Object(L.jsx)("tbody",Object(f.a)(Object(f.a)({},d()),{},{children:j.map((function(e,t){return h(e),Object(L.jsx)("tr",Object(f.a)(Object(f.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(L.jsx)("td",Object(f.a)(Object(f.a)({},e.getCellProps([{className:e.column.className}])),{},{children:e.render("Cell")}))}))}))}))}))]}))]})};n(101);x.a.extend(Ee.a);var tt=function(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e.blocks})),a=Object(l.c)((function(e){return e.links.to})),i=Object(r.useCallback)((function(e,n){t(X({type:"references",blockId:e}))}),[t]),o=c.a.useMemo((function(){return[{Header:"Title",className:"font-weight-bold",accessor:function(e){return Object(L.jsx)(A,{blockId:e.blockId,children:e.text},e.blockId)},sortType:function(e,t,n,r){return e.original.text.localeCompare(t.original.text)}},{Header:"Mentions",accessor:"mentions",className:"text-center",Cell:function(e){var t=e.row,n=e.value;return Object(L.jsx)("div",{className:"mentions-bubble",onClick:i.bind(null,t.original.blockId),children:Object(L.jsx)("span",{children:n.length})})},sortType:function(e,t,n,r){return e.original.mentions.length-t.original.mentions.length}},{Header:"Updated",accessor:"updated",className:"text-right",Cell:function(e){var t=e.value;return t?x()(t).format(O):null}},{Header:"Created",accessor:"created",className:"text-right",Cell:function(e){var t=e.value;return t?x()(t).format(O):null}}]}),[i]),s=c.a.useMemo((function(){return function(e,t){return Object.values(e).filter((function(e){return!e.parentId})).map((function(e){return{text:e.text,blockId:e.id,created:e.created,updated:e.updated,mentions:t[e.id]||[]}}))}(n,a)}),[n,a]);return Object(L.jsx)("div",{className:"all-pages",children:Object(L.jsx)(et,{columns:o,data:s})})},nt=function(e){return Object(L.jsx)("div",{className:"main",children:Object(L.jsxs)("div",{className:"stage",children:[Object(L.jsx)(d.b,{exact:!0,path:"/",children:Object(L.jsx)(d.a,{to:"/page/welcome"})}),Object(L.jsx)(d.b,{path:"/page/:blockId",render:function(e){var t=e.match;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(Le,{blockId:t.params.blockId}),Object(L.jsx)(ye,{blockId:t.params.blockId,isRoot:!0,isMain:!0})]})}}),Object(L.jsx)(d.b,{path:"/daily-notes",render:function(){return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(Le,{}),Object(L.jsx)(Ye,{})]})}}),Object(L.jsx)(d.b,{path:"/all-pages",render:function(){return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(Le,{}),Object(L.jsx)(tt,{})]})}})]})})},rt=n(115),ct=n(116);n(102);var at=function(e){var t=Object(l.c)((function(e){return e.blocks})),n=Object(l.c)((function(e){return e.filePane.favoriteBlockIds})).map((function(e){var n=t[e];return Object(L.jsx)(A,{blockId:e,className:"list-group-item list-group-item-action bg-dark text-light",children:n.text},e)}));return Object(L.jsxs)("div",{children:[Object(L.jsxs)("h5",{children:[Object(L.jsx)(Ne.a,{color:"white",width:"15px",style:{marginRight:"10px"}}),"Shortcuts"]}),Object(L.jsx)("div",{className:"list-group list-group-flush mt-3",children:n})]})},it=function(e){return Object(L.jsxs)("div",{className:"pane file-pane",children:[Object(L.jsx)(s.b,{to:"/",children:Object(L.jsx)("h2",{className:"text-light text-center",children:"Free-roam"})}),Object(L.jsx)(Ze,{}),Object(L.jsxs)("div",{className:"list-group list-group-flush mt-3",children:[Object(L.jsxs)(s.b,{to:"/daily-notes",className:"list-group-item list-group-item-action bg-dark text-light",children:[Object(L.jsx)(rt.a,{color:"white"})," Daily Notes"]}),Object(L.jsxs)(s.b,{to:"/all-pages",className:"list-group-item list-group-item-action bg-dark text-light",children:[Object(L.jsx)(ct.a,{color:"white"})," All Pages"]})]}),Object(L.jsx)("hr",{}),Object(L.jsx)(at,{})]})},lt=n(117),ot=(n(103),function(e){var t=Object(l.c)((function(e){return e.blocks})),n=Object(l.c)((function(e){return e.links})),r=Object(l.c)((function(e){return e.viewPane.views})),c=Object(l.b)(),a=function(e,t,n){c(D({type:e,blockId:t}))},i=function(e,t){var n;switch(e){case"page":n="Outline of:";break;case"block":n="Block outline of:";break;case"references":n=Object(L.jsxs)("span",{children:["References to: ",Object(L.jsx)(A,{blockId:t.id,children:t.text})]});break;default:n="Outline of:"}return n},o=r.map((function(e){var r=e.type,l=e.blockId;if(!(l in t))return null;var o=t[l],s=n.to[o.id]||[];return Object(L.jsxs)("div",{className:"view-pane__section",children:[Object(L.jsxs)("div",{className:"d-flex align-items-center",children:[i(r,o),Object(L.jsx)("div",{className:"flex-grow-1"}),"page"===r&&Object(L.jsx)("button",{className:"btn btn-dark btn-sm px-1 py-0",onClick:function(){return c(X({type:"references",blockId:l}))},children:s.length}),Object(L.jsx)(lt.a,{className:"btn-close",onClick:a.bind(null,r,o.id)})]}),"references"===r?Object(L.jsx)(E,{block:o,isMain:!0}):Object(L.jsx)(ye,{blockId:o.id,isRoot:!0,isMain:!1})]},"".concat(r,"-").concat(o.id))}));return Object(L.jsx)("div",{className:"pane view-pane",children:o})}),st=function(){return Object(L.jsx)("div",{className:"App",children:Object(L.jsxs)(s.a,{children:[Object(L.jsx)(it,{}),Object(L.jsx)(nt,{}),Object(L.jsx)(ot,{})]})})},dt={blocks:re,filePane:qe,viewPane:q,navbar:Re,links:ke,editor:oe},ut=Object(h.a)({reducer:dt});n(104);window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue=""})),i.a.render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(l.a,{store:ut,children:Object(L.jsx)(st,{})})}),document.getElementById("root")),o()},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.0ebe25e1.chunk.js.map