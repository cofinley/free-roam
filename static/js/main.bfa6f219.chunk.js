(this["webpackJsonpfree-roam"]=this["webpackJsonpfree-roam"]||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n(0),i=n.n(r),a=n(25),o=n.n(a),l=(n(51),n(14)),s=(n(52),n(6)),d=(n(53),n(13)),u=n(3),b=(n(58),n(5)),f=n(18),j=(n(59),n(8)),h=Object(j.b)({name:"viewPane",initialState:{views:[{type:"page",blockId:"abcd"},{type:"block",blockId:"a1"},{type:"references",blockId:"efgh"}]},reducers:{setViewPaneState:function(e,t){var n=t.payload;if(n&&"views"in n)return n},pushView:function(e,t){var n=t.payload,c=n.type,r=n.blockId;e.views.find((function(e){return e.type===c&&e.blockId===r}))||e.views.unshift(t.payload)},popView:function(e,t){var n=t.payload,c=n.type,r=n.blockId;e.views=e.views.filter((function(e){return"all"!==c&&e.type!==c||e.blockId!==r}))}}}),p=h.actions,v=p.setViewPaneState,k=p.pushView,O=p.popView,x=h.reducer,g=function(e){var t=e.blockId,n=e.isPage,r=void 0===n||n,i=e.children,a=e.noStyling,o=e.afterClick,s=Object(f.a)(e,["blockId","isPage","children","noStyling","afterClick"]),d=Object(u.b)(),j="/page/".concat(t);return Object(c.jsx)(l.b,Object(b.a)(Object(b.a)({to:j,onClick:function(e){e.shiftKey&&(e.preventDefault(),d(k({type:r?"page":"block",blockId:t}))),o&&o(),e.stopPropagation()},className:"block-link".concat(a?" block-link--no-styling":"")},s),{},{children:i}))},I=function(e){var t=e.block,n=e.isMain,i=Object(r.useState)(!1),a=Object(d.a)(i,2),o=a[0],l=a[1],s=Object(u.c)((function(e){return e.links})),b=Object(u.c)((function(e){return e.blocks})),f=s.to[t.id];return Object(c.jsxs)("div",{children:[null===t.parentId&&f&&f.length>0&&n&&Object(c.jsxs)("div",{className:"references references--linked",children:[Object(c.jsx)("b",{children:"Linked References"}),function(){if(!t.parentId&&f&&f.length)return f.map((function(e){if(!(e in b))return null;var t=b[e];return Object(c.jsxs)("div",{children:[Object(c.jsx)(g,{blockId:e,children:Object(c.jsx)("h4",{children:t.text})}),Object(c.jsx)(ke,{blockId:e,isRoot:!1})]},e)}))}()]}),null===t.parentId&&n&&Object(c.jsxs)("div",{className:"references",children:[Object(c.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){return l(!o)},children:"Unlinked References"}),o&&Object(c.jsx)("div",{className:"references references--unlinked",children:function(){if(!t.parentId&&o){var e=new RegExp("(?<![[w])".concat(t.text,"(?![[w]+)"),"gi"),r=Object.values(b).filter((function(t){return t.parentId&&e.test(t.text)})).map((function(e){return Object(c.jsxs)("div",{children:[Object(c.jsx)(g,{blockId:e.id,children:Object(c.jsx)("h4",{children:e.text})}),Object(c.jsx)(ke,{blockId:e.id,isRoot:!1,isMain:n})]},e.id)}));return r.length?r:Object(c.jsx)("span",{children:"No unlinked references"})}}()})]})]})},m=(n(61),n(45)),y=n(38),N=n.n(y),w=n(28),S=n(114),C=n(15),B=n.n(C),P=n(39),M=n.n(P);B.a.extend(M.a);var R="MMMM Do, YYYY",T="YYYY-MM-DD",F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=void 0===t?Object(S.a)():t,c=e.parentId,r=void 0===c?null:c,i=e.text,a=e.childrenIds,o=void 0===a?[]:a,l=e.created,s=void 0===l?Date.now():l,d=e.dailyNote,u=void 0===d?null:d,b=!r;if(b&&!u){var f=B()(i,R);f.isValid()&&(u=f.format(T))}return u&&(n=u),{id:n,parentId:r,text:i,childrenIds:o,created:s,updated:null,dailyNote:u}},_=function e(t,n){return t.parentId?e(n[t.parentId],n):t},D=function e(t,n){return t.childrenIds.length?e(n[t.childrenIds.slice(-1)],n):t},L=function e(t,n){var c=t.childrenIds,r=Object(f.a)(t,["childrenIds"]);return c.length?Object(b.a)(Object(b.a)({},r),{},{children:c.map((function(t){var c=n[t];return e(c,n)}))}):r},E=function e(t,n){var c;return t.childrenIds.length?(c=[t.id]).concat.apply(c,Object(w.a)(t.childrenIds.map((function(t){return e(n[t],n)})))):t.id},Y=n(40),A=Object(j.b)({name:"blocks",initialState:{abcd:{id:"abcd",parentId:null,text:"Hello World",childrenIds:["ijkl","mnop"]},efgh:{id:"efgh",parentId:null,text:"Lorem ipsum",childrenIds:["qrst"]},ijkl:{id:"ijkl",parentId:"abcd",text:"Normal *italics* **bold** ***bold italics***",childrenIds:[]},mnop:{id:"mnop",parentId:"abcd",text:"Link to [[Lorem ipsum]]",childrenIds:["uvwx","a1"]},qrst:{id:"qrst",parentId:"efgh",text:"Click here to edit",childrenIds:[]},uvwx:{id:"uvwx",parentId:"mnop",text:"I'm a third layer block",childrenIds:["a2"]},a1:{id:"a1",parentId:"mnop",text:"I'm another third layer block",childrenIds:[]},a2:{id:"a2",parentId:"uvwx",text:"I'm a fourth layer block",childrenIds:[]},"2021-02-17":F({id:"a3",text:"February 17th, 2021",childrenIds:["a4"],created:1613546102e3,dailyNote:"2021-02-17"}),a4:{id:"a4",parentId:"a3",text:"Click here to edit",childrenIds:[]}},reducers:{setBlocksState:function(e,t){var n=t.payload;if(n&&"object"===typeof n)return n},addBlock:function(e,t){var n=t.payload;if(n.parentId){e[n.parentId].childrenIds.push(n.id)}else{var c=F({parentId:n.id,text:"Click here to edit"});n.childrenIds.push(c.id),e[c.id]=c}e[n.id]=n},removeBlock:function(e,t){var n=t.payload.blockId,c=e[n];if(!c.childrenIds.length){var r=e[c.parentId];e[c.parentId].childrenIds=r.childrenIds.filter((function(e){return e!==n})),delete e[n]}},removePage:function(e,t){var n=t.payload.blockId,c=e[n];if(c.childrenIds.length){var r,i=Object(Y.a)(c.childrenIds);try{for(i.s();!(r=i.n()).done;){var a=r.value;A.caseReducers.removePage(e,{payload:{blockId:a}})}}catch(o){i.e(o)}finally{i.f()}delete e[n]}else delete e[n]},changeParent:function(e,t){var n=t.payload,c=n.blockId,r=n.parentId;e[c].parentId=r,e[r].childrenIds.push(c)},updateBlock:function(e,t){var n=t.payload,c=n.blockId,r=n.parentId,i=n.childrenIds,a=n.text,o=e[c];if(o){o.parentId=r||o.parentId,o.childrenIds=i||o.childrenIds;var l=o.text;o.text="string"===typeof a?a:l,o.updated=Date.now(),e[c]=o,o.parentId||A.caseReducers.changeTitle(e,{payload:{currentTitle:l,newTitle:a}})}},changeTitle:function(e,t){var n=t.payload,c=n.currentTitle,r=n.newTitle,i=new RegExp("\\[\\[".concat(c,"\\]\\]"),"g");Object.values(e).map((function(t){return i.test(t.text)&&(e[t.id].text=t.text.replace("[[".concat(c,"]]"),"[[".concat(r,"]]"))),!0}))},repositionBlock:function(e,t){var n=t.payload,c=n.blockId,r=n.direction,i=e[c],a=e[i.parentId],o=a.childrenIds.indexOf(i.id);if("forward"===r){if(o>0){var l=e[a.childrenIds[o-1]];a.childrenIds.splice(o,1),l.childrenIds.push(c),i.parentId=l.id}}else{var s=e[i.parentId];if(s.parentId){var d=e[s.parentId],u=d.childrenIds.indexOf(s.id);-1!==u&&(s.childrenIds.splice(o,1),d.childrenIds.splice(u+1,0,c),i.parentId=d.id)}}},makeSibling:function(e,t){var n=t.payload,c=n.firstSiblingBlockId,r=n.secondSiblingBlockId,i=e[c];if(i.parentId){var a=e[r];if(a.parentId){var o=e[a.parentId],l=o.childrenIds.indexOf(r);o.childrenIds.splice(l,1)}var s=e[i.parentId],d=s.childrenIds.indexOf(c);e[s.id].childrenIds.splice(d+1,0,r)}}}}),q=A.actions,H=q.setBlocksState,V=(q.getBlockByText,q.addBlock),J=q.removeBlock,Q=q.removePage,X=q.updateBlock,K=q.repositionBlock,G=q.makeSibling,U=A.reducer,W=Object(j.b)({name:"editor",initialState:{focusedBlock:{blockId:"",isMain:!0,caretPos:0}},reducers:{setEditorState:function(e,t){var n=t.payload;if(n&&"focusedBlock"in n)return n},updateFocusedBlock:function(e,t){e.focusedBlock=t.payload}}}),$=W.actions,z=$.setEditorState,Z=$.updateFocusedBlock,ee=W.reducer,te=(n(62),function(e){var t=e.query,n=e.useLinks,r=e.onResultClick,a=e.onlyPages,o=e.allowCreation,l=e.onCreateClick,s=Object(u.c)((function(e){return e.blocks})),d=[];if(t&&t.length){var b=Object.values(s).filter((function(e){return(!a||null===e.parentId)&&-1!==e.text.indexOf(t)}));if(d=b.map((function(e){return n?Object(c.jsx)(g,{blockId:e.id,className:"search-result",afterClick:r,children:e.text},e.id):Object(c.jsx)("li",{className:"search-result",onMouseDown:r.bind(null,e),children:e.text},e.id)})),o)if(!(void 0!==b.find((function(e){return e.text===t})))){var f=Object(c.jsxs)("li",{className:"search-result",onClick:l,children:[Object(c.jsx)("b",{children:"Create"})," ",t]},"new-page-".concat(t));d.splice(0,0,f)}}return Object(c.jsx)(i.a.Fragment,{children:d.length>0&&Object(c.jsx)("div",{className:"search-results",children:Object(c.jsx)("ul",{className:"list-group list-group-flush",children:d})})})}),ne=function(e){var t=e.block,n=e.isMain,i=e.isTitle,a=e.cursorCaret,o=e.setCursorCaret,l=e.onRender,s=Object(u.b)(),b=Object(r.useRef)(null),f=Object(r.useState)(!1),j=Object(d.a)(f,2),h=j[0],p=j[1],v=Object(u.c)((function(e){return e.editor.focusedBlock})),k=Object(u.c)((function(e){return e.blocks})),O=Object(r.useState)(!1),x=Object(d.a)(O,2),g=x[0],I=x[1],y=function(e){e.preventDefault(),e.shiftKey?s(K({blockId:t.id,direction:"backward"})):s(K({blockId:t.id,direction:"forward"})),s(Z({blockId:t.id,isMain:n,caretPos:e.target.selectionStart}))},w=function(e){e.preventDefault();var c="";if(e.target.selectionStart!==e.target.value.length){var r=e.target.selectionStart;c=t.text.substring(r);var i=t.text.substring(0,r);s(X({blockId:t.id,text:i})),e.target.value=i}var a=F({text:c,parentId:t.parentId});s(V(a)),s(G({firstSiblingBlockId:t.id,secondSiblingBlockId:a.id})),s(Z({blockId:a.id,isMain:n,caretPos:0}))},S=function(e){e.preventDefault();var t=e.target.selectionStart,n=e.target.value,c=n.charAt(t-1);e.target.value=n.substring(0,t)+"[]"+n.substring(t,n.length),e.target.selectionStart=t+1,e.target.selectionEnd=t+1,"["!==c||h?p(!1):(p(!0),I(""))},C=function(e){if(0===b.current.selectionStart&&!t.childrenIds.length){e.preventDefault();var c=_(t,k);if(!(t.parentId===c.id&&c.childrenIds[0]===t.id)){var r=function(e,t){var n=function(e,t){var n=t[e.parentId],c=n.childrenIds.indexOf(e.id);return c<1?null:t[n.childrenIds[c-1]]}(e,t);return n?n.childrenIds.length?D(n,t):n:t[e.parentId]}(t,k),i=r.text.length;s(X({blockId:r.id,text:r.text+t.text})),s(J({blockId:t.id})),s(Z({blockId:r.id,isMain:n,caretPos:i}))}}},B=v.blockId&&v.blockId===t.id&&v.isMain===n&&v.caretPos;return B&&b.current&&(b.current.focus(),b.current.selectionStart=v.caretPos),Object(c.jsxs)("div",{className:"block__autocomplete-container",children:[Object(c.jsx)(m.a,{ref:b,className:"block-text block-text--edit".concat(i?" block-text--title":""),autoFocus:!0,onFocus:function(e){B?e.target.selectionStart=v.caretPos:null!==a.offsetX&&function(e){if(e){for(var t=["*","_"],n=e.value,c=1e4,r=0,i=[],l=0;l<=e.value.length;l++){var s=e.value.charAt(l);if(t.includes(s)){var d=e.value.split("");d.splice(l,1),e.value=d.join(""),i.push(l),l--}var u=N()(e,l),b=u.left,f=u.top,j=Math.sqrt(Math.pow(b-a.offsetX,2)+Math.pow(f-a.offsetY,2));j<c&&(c=j,r=l)}e.value=n;var h=r;i.length&&i[0]<=h&&(h+=i.filter((function(e){return e<=r})).length),e.selectionStart=h,e.selectionEnd=h,o({offsetX:null,offsetY:null,width:null})}}(e.target)},onKeyDown:function(e){var t;"Tab"===e.key?y(e):"Enter"!==e.key||e.shiftKey?"["===e.key?S(e):"Backspace"===e.key?C(e):h&&(48<=(t=e.keyCode)&&t<91||96<=t&&t<112&&108!==t||186<=t)&&I(g+e.key):w(e)},onChange:function(e){h||t.text===e.target.value||s(X({blockId:t.id,text:e.target.value}))},onBlur:l,defaultValue:t.text}),h&&Object(c.jsx)(te,{query:g,onlyPages:!0,useLinks:!1,onResultClick:function(e,n){n.preventDefault();var c=e.text,r=b.current.value,i=b.current.selectionStart,a=r.substring(0,i).search(/\[\[(?!.*\]\])/gm),o=Array.from(r.substring(i).matchAll(/(?<!\[\[[^\]]+)]]/gm)).slice(-1)[0].index+i,l=r.substring(0,a+2)+c+r.substring(o);b.current.value=l,p(!1),I(null),s(X({blockId:t.id,text:l}))}})]})},ce=n(41),re=n(42),ie=n.n(re),ae=Object(j.b)({name:"links",initialState:{to:{efgh:["mnop"]},from:{mnop:["efgh"]}},reducers:{setLinksState:function(e,t){var n=t.payload;if(n&&"to"in n&&"from"in n)return n},setLinks:function(e,t){var n=t.payload,c=n.sourceBlockId,r=n.linkedBlockIds;if(c&&r&&r.length){var i;if(c in e.from){if(JSON.stringify(e.from[c].sort())===JSON.stringify(r.sort()))return;var a=e.from[c].filter((function(e){return!r.includes(e)}));a.length&&a.map((function(t){return e.to[t]=e.to[t].filter((function(e){return c!==e})),!0})),i=r.filter((function(t){return!e.from[c].includes(t)}))}else i=r;i.length&&i.map((function(t){return t in e.to||(e.to[t]=[]),e.to[t].push(c),!0})),e.from[c]=r}},removeBlockLinks:function(e,t){var n=t.payload.blockId,c=e.from[n];ae.caseReducers.setLinks(e,{payload:{sourceBlockId:n,linkedBlockIds:[]}}),c&&c.map((function(t){return e.to[t]=e.to[t].filter((function(e){return e!==n})),!0})),delete e.from[n]}}}),oe=ae.actions,le=oe.setLinksState,se=oe.setLinks,de=oe.removeBlockLinks,ue=ae.reducer,be=function(e){var t=e.block,n=e.isTitle,r=e.onEdit,a=Object(u.b)(),o=Object(u.c)((function(e){return e.blocks})),l=Object(u.c)((function(e){return e.links.from})),s=function(e){var n=new Set,r=ie()(e,/\[\[([^[\]]*)\]\]/g,(function(e,t){var r=d(e);return n.add(r.id),Object(c.jsx)(g,{blockId:r.id,children:r.text},"".concat(e,"-").concat(t))})),i=Array.from(n),o=t.id in l;return i.length&&(o&&JSON.stringify(i.sort())===JSON.stringify(l[t.id].sort())||a(se({sourceBlockId:t.id,linkedBlockIds:i}))),r},d=function(e){var t=Object.values(o).filter((function(e){return!e.parentId})).find((function(t){return t.text===e}));if(t)return t;var n=F({text:e});return a(V(n)),n};return Object(c.jsx)("span",{className:"block-text".concat(n?" block-text--title":""),onClick:r,children:function(){var e=t.text;return s(e).map((function(e){if("string"===typeof e){var t=Object(ce.a)(e);return i.a.cloneElement(t,{key:e})}return e}))}()})},fe=function(e){var t=e.block,n=e.isMain,i=e.isTitle,a=Object(u.c)((function(e){return e.editor.focusedBlock})),o=Object(r.useState)(a.isMain===n&&a.blockId===t.id),l=Object(d.a)(o,2),s=l[0],b=l[1],f=Object(r.useState)({offsetX:null,offsetY:null,width:null}),j=Object(d.a)(f,2),h=j[0],p=j[1];return a.blockId&&a.blockId===t.id&&a.isMain===n&&a.caretPos&&!s&&b(!0),Object(c.jsx)("div",{className:"block",children:s?Object(c.jsx)(ne,{block:t,isMain:n,isTitle:i,cursorCaret:h,setCursorCaret:p,onRender:function(e){b(!1)}}):Object(c.jsx)(be,{block:t,isTitle:i,onEdit:function(e){if(!t.dailyNote){var n=e.clientX,c=e.clientY,r=n-e.currentTarget.offsetLeft,i=c-e.currentTarget.offsetTop,a=e.currentTarget.offsetWidth;p({offsetX:r,offsetY:i,width:a}),b(!0)}}})})},je=function(e){var t=e.block,n=Object(u.c)((function(e){return e.blocks}));return Object(c.jsx)("div",{className:"breadcrumbs text-muted",children:function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)return r.reverse();var i=n[t],a=Object(c.jsx)(g,{blockId:t,isPage:null===i.parentId,noStyling:!0,children:i.text},t);return e(i.parentId,r.concat(a))}(t.parentId)})},he=n(102),pe=n(103),ve=(n(83),function(e){var t=e.block,n=e.hasChildren,r=e.foldBlock,i=e.setFoldBlock;return Object(c.jsxs)("div",{className:"block-actions-container",children:[Object(c.jsxs)("span",{className:"block-actions block-actions--toggle".concat(n?"":" hidden"),children:[r&&Object(c.jsx)(he.a,{color:"white",onClick:function(){return i(!1)}}),!r&&Object(c.jsx)(pe.a,{color:"white",onClick:function(){return i(!0)}})]}),Object(c.jsx)(g,{blockId:t.id,noStyling:!0,isPage:!1,children:Object(c.jsx)("div",{className:"block-actions block-actions--bullet".concat(r&&n?" fold":""),children:Object(c.jsx)("span",{children:"\u2022"})})})]})}),ke=function e(t){var n=t.blockId,i=t.isRoot,a=t.isMain,o=t.fold,l=void 0!==o&&o,s=Object(u.c)((function(e){return e.blocks}))[n],b=Object(r.useState)(l),f=Object(d.a)(b,2),j=f[0],h=f[1],p=Object(r.useState)(!1),v=Object(d.a)(p,2),k=v[0],O=v[1];if(Object(r.useEffect)((function(){h(l)}),[l]),!s)return Object(c.jsx)("h1",{className:"text-light",children:"Page not found"});var x=null===s.parentId,g=x&&i,m=s.childrenIds.map((function(t){return Object(c.jsx)(e,{isRoot:!1,isMain:a,blockId:t,fold:k},t)}));return Object(c.jsxs)("div",{className:"editor ".concat(i?"editor--root":"editor--child").concat(x?" editor--page":""),children:[i&&!x&&Object(c.jsx)(je,{block:s}),Object(c.jsxs)("div",{className:"d-flex",children:[!g&&Object(c.jsx)(ve,{block:s,foldBlock:j,setFoldBlock:h,hasChildren:m.length>0}),Object(c.jsx)(fe,{block:s,isTitle:g,isMain:a})]}),!j&&m.length>0&&Object(c.jsxs)("div",{className:"editor__children",children:[null!==s.parentId&&Object(c.jsx)("div",{className:"editor__children__thread-line",onClick:function(){return O(!k)}}),Object(c.jsx)("div",{className:"editor__children__container",children:m})]}),i&&Object(c.jsx)(I,{block:s,isMain:a},s.id)]})},Oe=n(104),xe=n(105),ge=n(106),Ie=(n(84),Object(j.b)({name:"navbar",initialState:{searchQuery:""},reducers:{setNavbarState:function(e,t){var n=t.payload;if(n&&"searchQuery"in n)return n},updateSearchQuery:function(e,t){var n=t.payload.query;e.searchQuery=n}}})),me=Ie.actions,ye=me.setNavbarState,Ne=me.updateSearchQuery,we=(me.removeShortcut,Ie.reducer),Se=Object(j.b)({name:"filePane",initialState:{favoriteBlockIds:["abcd","efgh"]},reducers:{setFilePaneState:function(e,t){var n=t.payload;if(n&&"favoriteBlockIds"in n)return n},toggleShortcut:function(e,t){var n=t.payload.blockId;e.favoriteBlockIds.indexOf(n)>-1?e.favoriteBlockIds=e.favoriteBlockIds.filter((function(e){return n!==e})):e.favoriteBlockIds.push(n)},removeShortcut:function(e,t){var n=t.payload.blockId;e.favoriteBlockIds=e.favoriteBlockIds.filter((function(e){return e!==n}))}}}),Ce=Se.actions,Be=Ce.setFilePaneState,Pe=Ce.toggleShortcut,Me=Ce.removeShortcut,Re=Se.reducer,Te=function(e){var t,n=e.blockId,r=Object(u.b)(),i=Object(u.c)((function(e){return e.navbar.searchQuery})),a=Object(u.c)((function(e){return e.blocks})),o=Object(u.c)((function(e){return e.filePane.favoriteBlockIds})),l=Object(s.e)(),d=function e(t){return t.parentId?e(a[t.parentId]):t.id};if(n){var b=a[n];if(b){var f=d(b);t=o.includes(f)}}var j;void 0!==t&&(j=t?Object(c.jsx)(Oe.a,{color:"white"}):Object(c.jsx)(xe.a,{color:"white"}));var h=function(e){r(Ne({query:""}))};return Object(c.jsxs)("div",{className:"navbar",children:[Object(c.jsxs)("div",{className:"search-container",children:[Object(c.jsxs)("div",{className:"input-group",children:[Object(c.jsx)("div",{className:"input-group-prepend",children:Object(c.jsx)("span",{className:"input-group-text bg-dark text-dark border-secondary",children:Object(c.jsx)(ge.a,{color:"white"})})}),Object(c.jsx)("input",{type:"text",className:"form-control bg-dark text-light border-secondary",placeholder:"Find or Create Page",onChange:function(e){return r(Ne({query:e.target.value}))},value:i})]}),Object(c.jsx)(te,{query:i,useLinks:!0,onResultClick:h,allowCreation:!0,onCreateClick:function(){var e=F({text:i});r(V(e)),h(),l.push("/page/".concat(e.id))}})]}),void 0!==j&&Object(c.jsx)("button",{className:"btn btn--toggle-favorite",onClick:function(e){var t=d(a[n]);r(Pe({blockId:t}))},children:j})]})},Fe=n(27),_e=n.n(Fe);n(85);B.a.extend(_e.a);var De=function(e){var t=Object(u.b)(),n=Object(u.c)((function(e){return e.blocks})),r=Object.values(n).filter((function(e){return!!e.dailyNote})).sort((function(e,t){return e.dailyNote.localeCompare(t.dailyNote)})).reverse(),i=B()(),a=i.format(R),o=r.find((function(e){return e.text===a}));o||(o=F({text:a,dailyNote:i.format(T)}),t(V(o)));var l=r.map((function(e){return Object(c.jsx)(ke,{blockId:e.id,isMain:!0,isRoot:!0},e.id)}));return Object(c.jsx)("div",{className:"daily-notes",children:l})},Le=n(29),Ee=n(107),Ye=n(108),Ae=n(109),qe=n(110),He=n(43),Ve=n(44),Je=n.n(Ve),Qe=(n(96),function(e){var t=new Je.a;e.map((function(e){var n=e.content,c=e.fileName;return t.file(c||"free-roam.json",JSON.stringify(n)),!0})),t.generateAsync({type:"blob"}).then((function(e){Object(He.saveAs)(e,"Free-Roam-Export-".concat(Date.now()))}))}),Xe=function(e){var t=Object(u.b)(),n=Object(u.c)((function(e){return e}));return Object(c.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(c.jsx)("label",{className:"load-button-input mr-3",children:Object(c.jsx)("input",{type:"file",className:"btn btn-secondary",accept:".json",onChange:function(e){e.preventDefault();var n=new FileReader;n.onload=function(e){var n=JSON.parse(e.target.result);"blocks"in n&&t(H(n.blocks)),"editor"in n&&t(z(n.editor)),"filePane"in n&&t(Be(n.filePane)),"links"in n&&t(le(n.links)),"navbar"in n&&t(ye(n.navbar)),"viewPane"in n&&t(v(n.viewPane))},n.readAsText(e.target.files[0])}})}),Object(c.jsx)("button",{className:"btn btn-secondary",onClick:function(){return Qe([{content:n,fileName:"free-roam.json"}])},children:"Save"})]})},Ke=i.a.forwardRef((function(e,t){var n=e.indeterminate,r=Object(f.a)(e,["indeterminate"]),a=i.a.useRef(),o=t||a;return i.a.useEffect((function(){o.current.indeterminate=n}),[o,n]),Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("input",Object(b.a)({type:"checkbox",ref:o},r))})})),Ge=function(e){var t=e.columns,n=e.data,r=Object(u.b)(),i=Object(u.c)((function(e){return e.blocks})),a=Object(u.c)((function(e){return e.links.to})),o=function(e){e.length&&e.map((function(e){return e.original.blockId})).map((function(e){var t=i[e];return E(i[e],i).map((function(e){return r(O({type:"all",blockId:e})),(a[e]||[]).map((function(e){var n=i[e],c=new RegExp("\\[\\[(".concat(t.text,")\\]\\]"),"g"),a=n.text.replace(c,"$1");return r(X({blockId:e,text:a})),!0})),r(de({blockId:e})),!0})),r(Me({blockId:e})),r(Q({blockId:e})),!0}))},l=Object(Le.useTable)({columns:t,data:n},Le.useSortBy,Le.useRowSelect,(function(e){e.visibleColumns.push((function(e){return[{id:"selection",Header:function(e){var t=e.getToggleAllRowsSelectedProps;return Object(c.jsx)("div",{children:Object(c.jsx)(Ke,Object(b.a)({},t()))})},Cell:function(e){var t=e.row;return Object(c.jsx)("div",{children:Object(c.jsx)(Ke,Object(b.a)({},t.getToggleRowSelectedProps()))})}}].concat(Object(w.a)(e))}))})),s=l.getTableProps,d=l.getTableBodyProps,f=l.headerGroups,j=l.rows,h=l.prepareRow,p=l.selectedFlatRows,v=l.state.selectedRowIds;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"all-pages__toolbar",children:[Object(c.jsx)(Ee.a,{onClick:function(){return o(p)},className:"mr-3 all-pages__button".concat(Object.keys(v).length?" active":"")}),Object(c.jsx)(Ye.a,{onClick:function(){return function(e){if(e.length){var t=e.map((function(e){return e.original.blockId})).map((function(e){var t=i[e];return{content:L(t,i),fileName:"".concat(t.text,".json")}}));Qe(t)}}(p)},className:"all-pages__button".concat(Object.keys(v).length?" active":"")}),Object(c.jsx)("div",{className:"flex-grow-1"})]}),Object(c.jsxs)("table",Object(b.a)(Object(b.a)({className:"table table-dark"},s()),{},{children:[Object(c.jsx)("thead",{className:"thead-dark",children:f.map((function(e){return Object(c.jsx)("tr",Object(b.a)(Object(b.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(c.jsxs)("th",Object(b.a)(Object(b.a)({scope:"col"},e.getHeaderProps([{className:e.className},e.getSortByToggleProps()])),{},{children:[e.render("Header"),Object(c.jsx)("span",{children:e.isSorted?e.isSortedDesc?Object(c.jsx)(Ae.a,{color:"white"}):Object(c.jsx)(qe.a,{color:"white"}):""})]}))}))}))}))}),Object(c.jsx)("tbody",Object(b.a)(Object(b.a)({},d()),{},{children:j.map((function(e,t){return h(e),Object(c.jsx)("tr",Object(b.a)(Object(b.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(c.jsx)("td",Object(b.a)(Object(b.a)({},e.getCellProps([{className:e.column.className}])),{},{children:e.render("Cell")}))}))}))}))}))]}))]})};n(97);B.a.extend(_e.a);var Ue=function(e){var t=Object(u.b)(),n=Object(u.c)((function(e){return e.blocks})),a=Object(u.c)((function(e){return e.links.to})),o=Object(r.useCallback)((function(e,n){t(k({type:"references",blockId:e}))}),[t]),l=i.a.useMemo((function(){return[{Header:"Title",className:"font-weight-bold",accessor:function(e){return Object(c.jsx)(g,{blockId:e.blockId,children:e.text},e.blockId)},sortType:function(e,t,n,c){return e.original.text.localeCompare(t.original.text)}},{Header:"Mentions",accessor:"mentions",className:"text-center",Cell:function(e){var t=e.row,n=e.value;return Object(c.jsx)("div",{className:"mentions-bubble",onClick:o.bind(null,t.original.blockId),children:Object(c.jsx)("span",{children:n.length})})},sortType:function(e,t,n,c){return e.original.mentions.length-t.original.mentions.length}},{Header:"Updated",accessor:"updated",className:"text-right",Cell:function(e){var t=e.value;return t?B()(t).format(R):null}},{Header:"Created",accessor:"created",className:"text-right",Cell:function(e){var t=e.value;return t?B()(t).format(R):null}}]}),[o]),s=i.a.useMemo((function(){return function(e,t){return Object.values(e).filter((function(e){return!e.parentId})).map((function(e){return{text:e.text,blockId:e.id,created:e.created,updated:e.updated,mentions:t[e.id]||[]}}))}(n,a)}),[n,a]);return Object(c.jsx)("div",{className:"all-pages",children:Object(c.jsx)(Ge,{columns:l,data:s})})},We=function(e){var t=e.blockId;return Object(c.jsxs)("div",{className:"main",children:[Object(c.jsx)(Te,{blockId:t}),Object(c.jsxs)("div",{className:"stage",children:[Object(c.jsx)(s.a,{exact:!0,path:"/",render:function(){return Object(c.jsx)(ke,{blockId:null,isRoot:!0,isMain:!0})}}),Object(c.jsx)(s.a,{path:"/page/:blockId",render:function(e){var t=e.match;return Object(c.jsx)(ke,{blockId:t.params.blockId,isRoot:!0,isMain:!0})}}),Object(c.jsx)(s.a,{path:"/daily-notes",render:function(){return Object(c.jsx)(De,{})}}),Object(c.jsx)(s.a,{path:"/all-pages",render:function(){return Object(c.jsx)(Ue,{})}})]})]})},$e=n(111),ze=n(112);n(98);var Ze=function(e){var t=Object(u.c)((function(e){return e.blocks})),n=Object(u.c)((function(e){return e.filePane.favoriteBlockIds})).map((function(e){var n=t[e];return Object(c.jsx)(g,{blockId:e,className:"list-group-item list-group-item-action bg-dark text-light",children:n.text},e)}));return Object(c.jsxs)("div",{children:[Object(c.jsxs)("h5",{children:[Object(c.jsx)(Oe.a,{color:"white",width:"15px",style:{marginRight:"10px"}}),"Shortcuts"]}),Object(c.jsx)("div",{className:"list-group list-group-flush mt-3",children:n})]})},et=function(e){return Object(c.jsxs)("div",{className:"pane file-pane",children:[Object(c.jsx)(l.b,{to:"/",children:Object(c.jsx)("h2",{className:"text-light text-center",children:"Free-roam"})}),Object(c.jsx)(Xe,{}),Object(c.jsxs)("div",{className:"list-group list-group-flush mt-3",children:[Object(c.jsxs)(l.b,{to:"/daily-notes",className:"list-group-item list-group-item-action bg-dark text-light",children:[Object(c.jsx)($e.a,{color:"white"})," Daily Notes"]}),Object(c.jsxs)(l.b,{to:"/all-pages",className:"list-group-item list-group-item-action bg-dark text-light",children:[Object(c.jsx)(ze.a,{color:"white"})," All Pages"]})]}),Object(c.jsx)("hr",{}),Object(c.jsx)(Ze,{})]})},tt=n(113),nt=(n(99),function(e){var t=Object(u.c)((function(e){return e.blocks})),n=Object(u.c)((function(e){return e.viewPane.views})),r=Object(u.b)(),i=function(e,t,n){r(O({type:e,blockId:t}))},a=function(e,t){var n;switch(e){case"page":n="Outline of:";break;case"block":n="Block outline of:";break;case"references":n=Object(c.jsxs)("span",{children:["References to: ",Object(c.jsx)(g,{blockId:t.id,children:t.text})]});break;default:n="Outline of:"}return n},o=n.map((function(e){var n=e.type,r=e.blockId;if(!(r in t))return null;var o=t[r];return Object(c.jsxs)("div",{className:"view-pane__section",children:[Object(c.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[a(n,o),Object(c.jsx)(tt.a,{className:"btn-close",onClick:i.bind(null,n,o.id)})]}),"references"===n?Object(c.jsx)(I,{block:o,isMain:!0}):Object(c.jsx)(ke,{blockId:o.id,isRoot:!0,isMain:!1})]},"".concat(n,"-").concat(o.id))}));return Object(c.jsx)("div",{className:"pane view-pane",children:o})}),ct=function(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(et,{}),Object(c.jsx)(We,{}),Object(c.jsx)(nt,{})]})})},rt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,115)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),i(e),a(e)}))},it=Object(j.a)({reducer:{blocks:U,filePane:Re,viewPane:x,navbar:we,links:ue,editor:ee}});window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue=""})),o.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(u.a,{store:it,children:Object(c.jsx)(ct,{})})}),document.getElementById("root")),rt()},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.bfa6f219.chunk.js.map