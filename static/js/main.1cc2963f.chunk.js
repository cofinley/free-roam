(this["webpackJsonpfree-roam"]=this["webpackJsonpfree-roam"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(26),i=n.n(a),l=n(3),o=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,118)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))},s=n(14),d=(n(57),n(6)),u=(n(58),n(9)),b=(n(59),n(28)),f=n(5),j=n(20),h=n(7),p=n(15),x=n.n(p),v=n(39),O=n.n(v);x.a.extend(O.a);var k="MMMM Do, YYYY",I="YYYY-MM-DD",g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=void 0===t?Object(h.c)(8):t,c=e.parentId,r=void 0===c?null:c,a=e.text,i=e.childrenIds,l=void 0===i?[]:i,o=e.created,s=void 0===o?Date.now():o,d=e.dailyNote,u=void 0===d?null:d,b=arguments.length>1?arguments[1]:void 0,f=!r;if(f&&!u){var j=x()(a,k);j.isValid()&&(u=j.format(I))}if(u){if(u in b)return null;n=u}else if(n in b)for(;n in b;)n=Object(h.c)(8);return{id:n,parentId:r,text:a,childrenIds:l,created:s,updated:null,dailyNote:u}},m=function e(t,n){return t.parentId?e(n[t.parentId],n):t},y=function e(t,n){return t.childrenIds.length?e(n[t.childrenIds.slice(-1)],n):t},N=function e(t,n){var c=t.childrenIds,r=Object(j.a)(t,["childrenIds"]);return c.length?Object(f.a)(Object(f.a)({},r),{},{children:c.map((function(t){var c=n[t];return e(c,n)}))}):r},w=function e(t,n){var c;return t.childrenIds.length?(c=[t.id]).concat.apply(c,Object(b.a)(t.childrenIds.map((function(t){return e(n[t],n)})))):t.id},B=n(106),S=n(107),C=(n(60),Object(h.b)({name:"viewPane",initialState:{views:[{type:"page",blockId:"efgh"}]},reducers:{setViewPaneState:function(e,t){var n=t.payload;if(n&&"views"in n)return n},pushView:function(e,t){var n=t.payload,c=n.type,r=n.blockId;e.views.find((function(e){return e.type===c&&e.blockId===r}))||e.views.unshift(t.payload)},popView:function(e,t){var n=t.payload,c=n.type,r=n.blockId;e.views=e.views.filter((function(e){return"all"!==c&&e.type!==c||e.blockId!==r}))}}})),P=C.actions,M=P.setViewPaneState,R=P.pushView,T=P.popView,_=C.reducer,F=n(1),X=function(e){var t=e.blockId,n=e.isPage,c=void 0===n||n,r=e.children,a=e.noStyling,i=e.afterClick,o=Object(j.a)(e,["blockId","isPage","children","noStyling","afterClick"]),d=Object(l.b)(),u="/page/".concat(t);return Object(F.jsx)(s.b,Object(f.a)(Object(f.a)({to:u,onClick:function(e){e.shiftKey&&(e.preventDefault(),d(R({type:c?"page":"block",blockId:t}))),i&&i(),e.stopPropagation()},className:"block-link".concat(a?" block-link--no-styling":"")},o),{},{children:r}))},D=function(e){var t=e.block,n=e.isMain,r=Object(c.useState)(!0),a=Object(u.a)(r,2),i=a[0],o=a[1],s=Object(c.useState)(!1),d=Object(u.a)(s,2),b=d[0],f=d[1],j=Object(c.useState)(null),h=Object(u.a)(j,2),p=h[0],x=h[1],v=Object(l.c)((function(e){return e.links})),O=Object(l.c)((function(e){return e.blocks})),k=v.to[t.id];return Object(F.jsxs)("div",{children:[null===t.parentId&&k&&k.length>0&&n&&Object(F.jsxs)("div",{className:"references references--linked",children:[Object(F.jsxs)("span",{className:"references__toggle no-select",onClick:function(){return o((function(e){return!e}))},children:[i?Object(F.jsx)(B.a,{color:"white"}):Object(F.jsx)(S.a,{color:"white"}),Object(F.jsxs)("b",{children:[k.length," Linked References"]})]}),i&&function(){if(!t.parentId&&k&&k.length)return k.map((function(e){if(!(e in O))return null;var t=O[e],c=m(t,O);return Object(F.jsxs)("div",{children:[Object(F.jsx)(X,{blockId:c.id,children:Object(F.jsx)("h5",{children:c.text})}),Object(F.jsx)("div",{className:"reference-container",children:Object(F.jsx)(ke,{blockId:e,isRoot:!1,isMain:n,fold:!0,showBreadcrumbs:!0})})]},e)}))}()]}),null===t.parentId&&n&&Object(F.jsxs)("div",{className:"references references--unlinked",children:[Object(F.jsxs)("span",{className:"references__toggle no-select",onClick:function(e){b?f(!1):(f(!0),x(function(e){var t=new RegExp("(?<![\\[\\w])".concat(e,"(?![\\[\\w]+)"),"gi");return Object.values(O).filter((function(e){return e.parentId&&t.test(e.text)}))}(t.text)))},children:[b?Object(F.jsx)(B.a,{color:"white"}):Object(F.jsx)(S.a,{color:"white"}),Object(F.jsxs)("b",{children:[p&&p.length?p.length:""," Unlinked References"]})]}),b&&function(){if(!t.parentId&&b)return p.length?p.map((function(e){var t=m(e,O);return Object(F.jsxs)("div",{children:[Object(F.jsx)(X,{blockId:t.id,children:Object(F.jsx)("h5",{children:t.text})}),Object(F.jsx)("div",{className:"reference-container",children:Object(F.jsx)(ke,{blockId:e.id,isRoot:!1,isMain:n,fold:!0,showBreadcrumbs:!0})})]},e.id)})):Object(F.jsx)("p",{children:"No unlinked references"})}()]})]})},q=(n(65),n(46)),L=n(41),E=n.n(L),Y=n(19),A=function(e,t){var n,c=e.matchAll(/\[\[([^\]]*(?:\]\])?)\]\]/gm),r=!1,a=null,i=Object(Y.a)(c);try{for(i.s();!(n=i.n()).done;){var l=n.value,o=l[0],s=l.index,d=s+o.length-2;if(r=s+2<=t&&t<=d)return{startBracketIndex:s,endBracketIndex:d,caretInBrackets:r,textInBrackets:a=l[1]}}}catch(u){i.e(u)}finally{i.f()}return{startBracketIndex:-1,endBracketIndex:-1,caretInBrackets:r,textInBrackets:a}},H={abcd:{id:"abcd",parentId:null,text:"Hello World",childrenIds:["ijkl","mnop"]},efgh:{id:"efgh",parentId:null,text:"Lorem ipsum",childrenIds:["qrst"]},ijkl:{id:"ijkl",parentId:"abcd",text:"Normal *italics* **bold** ***bold italics***",childrenIds:[]},mnop:{id:"mnop",parentId:"abcd",text:"Link to [[Lorem ipsum]]",childrenIds:["uvwx","a1"]},qrst:{id:"qrst",parentId:"efgh",text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",childrenIds:[]},uvwx:{id:"uvwx",parentId:"mnop",text:"I'm a third layer block",childrenIds:["a2"]},a1:{id:"a1",parentId:"mnop",text:"I'm another third layer block",childrenIds:[]},a2:{id:"a2",parentId:"uvwx",text:"I'm a fourth layer block",childrenIds:[]},"2021-02-17":{id:"2021-02-17",parentId:null,text:"February 17th, 2021",childrenIds:["a4"],created:1613546102e3,updated:null,dailyNote:"2021-02-17"},a4:{id:"a4",parentId:"a3",text:"Click here to edit",childrenIds:[]},plXnqf7B:{id:"plXnqf7B",parentId:"welcome",text:"Welcome to Free-Roam!",childrenIds:[],created:1613962018019,updated:1613962047962,dailyNote:null},welcome:{id:"welcome",parentId:null,text:"Welcome",childrenIds:["plXnqf7B","0NOhIzxB","H-O00XW0","64SNNX17"],created:1613962018016,updated:null,dailyNote:null},"0NOhIzxB":{id:"0NOhIzxB",parentId:"welcome",text:"Take a look around; you can check out:",childrenIds:["pKs_vxuk","ANZddpXT","NMb4Yf1z"],created:1613962048878,updated:1613962057083,dailyNote:null},pKs_vxuk:{id:"pKs_vxuk",parentId:"0NOhIzxB",text:"[Daily Notes](#/daily-notes) (like a journal)",childrenIds:[],created:1613962057397,updated:1613962069453,dailyNote:null},ANZddpXT:{id:"ANZddpXT",parentId:"0NOhIzxB",text:"All of the [current pages](#/all-pages)",childrenIds:[],created:1613962070989,updated:1613962076848,dailyNote:null},NMb4Yf1z:{id:"NMb4Yf1z",parentId:"0NOhIzxB",text:"A sample page: [[Hello World]]",childrenIds:["nbGfXXqe"],created:1613962077493,updated:1613962081636,dailyNote:null},nbGfXXqe:{id:"nbGfXXqe",parentId:"NMb4Yf1z",text:"Shift+click to open in side bar",childrenIds:[],created:1613962082245,updated:1613962090754,dailyNote:null},"H-O00XW0":{id:"H-O00XW0",parentId:"welcome",text:"Be sure to save your work if you wish to persist it",childrenIds:["mPiN8jkq"],created:1613962091917,updated:1613962107536,dailyNote:null},mPiN8jkq:{id:"mPiN8jkq",parentId:"H-O00XW0",text:"Save/load buttons in top left",childrenIds:[],created:1613962107877,updated:1613962114571,dailyNote:null},"64SNNX17":{id:"64SNNX17",parentId:"welcome",text:"Enjoy! Check out [the repo](https://github.com/cofinley/free-roam) to learn more and/or contribute!",childrenIds:[],created:1613962115053,updated:1613962120478,dailyNote:null}},z=Object(h.b)({name:"blocks",initialState:H,reducers:{setBlocksState:function(e,t){var n=t.payload;if(n&&"object"===typeof n)return n},addBlock:function(e,t){var n=t.payload;if(n.parentId){e[n.parentId].childrenIds.push(n.id)}else{var c=g({parentId:n.id,text:"Click here to edit"},e);n.childrenIds.push(c.id),e[c.id]=c}e[n.id]=n},removeBlock:function(e,t){var n=t.payload.blockId,c=e[n];if(!c.childrenIds.length){var r=e[c.parentId];e[c.parentId].childrenIds=r.childrenIds.filter((function(e){return e!==n})),delete e[n]}},removePage:function(e,t){var n=t.payload.blockId,c=e[n];if(c.childrenIds.length){var r,a=Object(Y.a)(c.childrenIds);try{for(a.s();!(r=a.n()).done;){var i=r.value;z.caseReducers.removePage(e,{payload:{blockId:i}})}}catch(l){a.e(l)}finally{a.f()}delete e[n]}else delete e[n]},changeParent:function(e,t){var n=t.payload,c=n.blockId,r=n.parentId;e[c].parentId=r,e[r].childrenIds.push(c)},updateBlock:function(e,t){var n=t.payload,c=n.blockId,r=n.parentId,a=n.childrenIds,i=n.text,l=e[c];if(l){l.parentId=r||l.parentId,l.childrenIds=a||l.childrenIds;var o=l.text;l.text="string"===typeof i?i:o,l.updated=Date.now(),e[c]=l,l.parentId||z.caseReducers.changeTitle(e,{payload:{currentTitle:o,newTitle:i}})}},changeTitle:function(e,t){var n=t.payload,c=n.currentTitle,r=n.newTitle,a=new RegExp("\\[\\[".concat(c,"\\]\\]"),"g");Object.values(e).map((function(t){return a.test(t.text)&&(e[t.id].text=t.text.replace("[[".concat(c,"]]"),"[[".concat(r,"]]"))),!0}))},repositionBlock:function(e,t){var n=t.payload,c=n.blockId,r=n.direction,a=e[c],i=e[a.parentId],l=i.childrenIds.indexOf(a.id);if("forward"===r){if(l>0){var o=e[i.childrenIds[l-1]];i.childrenIds.splice(l,1),o.childrenIds.push(c),a.parentId=o.id}}else{var s=e[a.parentId];if(s.parentId){var d=e[s.parentId],u=d.childrenIds.indexOf(s.id);-1!==u&&(s.childrenIds.splice(l,1),d.childrenIds.splice(u+1,0,c),a.parentId=d.id)}}},makeSibling:function(e,t){var n=t.payload,c=n.firstSiblingBlockId,r=n.secondSiblingBlockId,a=e[c];if(a.parentId){var i=e[r];if(i.parentId){var l=e[i.parentId],o=l.childrenIds.indexOf(r);l.childrenIds.splice(o,1)}var s=e[a.parentId],d=s.childrenIds.indexOf(c);e[s.id].childrenIds.splice(d+1,0,r)}}}}),V=z.actions,W=V.setBlocksState,K=(V.getBlockByText,V.addBlock),J=V.removeBlock,Q=V.removePage,G=V.updateBlock,U=V.repositionBlock,Z=V.makeSibling,$=z.reducer,ee=Object(h.b)({name:"editor",initialState:{focusedBlock:{blockId:"",isMain:!0,caretPos:0}},reducers:{setEditorState:function(e,t){var n=t.payload;if(n&&"focusedBlock"in n)return n},updateFocusedBlock:function(e,t){e.focusedBlock=t.payload}}}),te=ee.actions,ne=te.setEditorState,ce=te.updateFocusedBlock,re=ee.reducer,ae=(n(66),function(e){var t=e.query,n=e.useLinks,c=e.onResultClick,a=e.onlyPages,i=e.allowCreation,o=e.onCreateClick,s=Object(l.c)((function(e){return e.blocks})),d=[];if(t&&t.length){var u=Object.values(s).filter((function(e){return(!a||null===e.parentId)&&-1!==e.text.indexOf(t)}));if(d=u.map((function(e){return n?Object(F.jsx)(X,{blockId:e.id,className:"search-result",afterClick:c,children:e.text},e.id):Object(F.jsx)("li",{className:"search-result",onMouseDown:c.bind(null,e),children:e.text},e.id)})),i){if(!(void 0!==u.find((function(e){return e.text===t})))){var b=Object(F.jsxs)("li",{className:"search-result",onClick:o,children:[Object(F.jsx)("b",{children:"Create"})," ",t]},"new-page-".concat(t));d.splice(0,0,b)}}else if(!d.length){var f=Object(F.jsx)("li",{className:"search-result",children:Object(F.jsx)("span",{children:"Search for a page"})},"default-suggestion");d.splice(0,0,f)}}return Object(F.jsx)(r.a.Fragment,{children:d.length>0&&Object(F.jsx)("div",{className:"search-results",children:Object(F.jsx)("ul",{className:"list-group list-group-flush",children:d})})})}),ie=function(e){var t=e.block,n=e.isMain,r=e.isTitle,a=e.cursorCaret,i=e.setCursorCaret,o=e.onRender,s=Object(l.b)(),d=Object(c.useRef)(null),b=Object(c.useState)(!1),f=Object(u.a)(b,2),j=f[0],h=f[1],p=Object(l.c)((function(e){return e.editor.focusedBlock})),x=Object(l.c)((function(e){return e.blocks})),v=Object(c.useState)(!1),O=Object(u.a)(v,2),k=O[0],I=O[1],N=function(e){e.preventDefault(),e.shiftKey?s(U({blockId:t.id,direction:"backward"})):s(U({blockId:t.id,direction:"forward"})),s(ce({blockId:t.id,isMain:n,caretPos:e.target.selectionStart}))},w=function(e){e.preventDefault();var c="";if(e.target.selectionStart!==e.target.value.length){var r=e.target.selectionStart;c=t.text.substring(r);var a=t.text.substring(0,r);s(G({blockId:t.id,text:a})),e.target.value=a}var i=g({text:c,parentId:t.parentId},x);s(K(i)),s(Z({firstSiblingBlockId:t.id,secondSiblingBlockId:i.id})),s(ce({blockId:i.id,isMain:n,caretPos:0}))},B=function(e){e.preventDefault();var t=e.target.selectionStart,n=e.target.value,c=n.charAt(t-1);if(e.target.value=n.substring(0,t)+"[]"+n.substring(t,n.length),e.target.selectionStart=t+1,e.target.selectionEnd=t+1,"["===c&&!j)return h(!0),void I("");h(!1)},S=function(e){if(0===d.current.selectionStart&&!t.childrenIds.length){e.preventDefault();var c=m(t,x);if(!(t.parentId===c.id&&c.childrenIds[0]===t.id)){var r=function(e,t){var n=function(e,t){var n=t[e.parentId],c=n.childrenIds.indexOf(e.id);return c<1?null:t[n.childrenIds[c-1]]}(e,t);return n?n.childrenIds.length?y(n,t):n:t[e.parentId]}(t,x),a=r.text.length;s(G({blockId:r.id,text:r.text+t.text})),s(J({blockId:t.id})),s(ce({blockId:r.id,isMain:n,caretPos:a}))}}},C=p.blockId&&p.blockId===t.id&&p.isMain===n&&p.caretPos;C&&d.current&&(d.current.focus(),d.current.selectionStart=p.caretPos);return Object(F.jsxs)("div",{className:"block__autocomplete-container",children:[Object(F.jsx)(q.a,{ref:d,className:"block-text block-text--edit".concat(r?" block-text--title":""),autoFocus:!0,onFocus:function(e){C?e.target.selectionStart=p.caretPos:null!==a.offsetX&&function(e){if(e){for(var t=["*","_"],n=e.value,c=1e4,r=0,l=[],o=0;o<=e.value.length;o++){var s=e.value.charAt(o);if(t.includes(s)){var d=e.value.split("");d.splice(o,1),e.value=d.join(""),l.push(o),o--}var u=E()(e,o),b=u.left,f=u.top,j=Math.sqrt(Math.pow(b-a.offsetX,2)+Math.pow(f-a.offsetY,2));j<c&&(c=j,r=o)}e.value=n;var h=r;l.length&&l[0]<=h&&(h+=l.filter((function(e){return e<=r})).length),e.selectionStart=h,e.selectionEnd=h,i({offsetX:null,offsetY:null,width:null})}}(e.target)},onKeyDown:function(e){"Tab"===e.key?N(e):"Enter"!==e.key||e.shiftKey?"["===e.key?B(e):"Backspace"===e.key&&S(e):w(e)},onChange:function(e){j||t.text===e.target.value||s(G({blockId:t.id,text:e.target.value}))},onKeyUp:function(e){var t=e.target.selectionStart,n=A(e.target.value,t);n.caretInBrackets?(h(!0),console.log(n.textInBrackets),I(n.textInBrackets)):h(!1),console.log(j)},onBlur:function(e){var n;n=e.target.value,t.text!==n&&s(G({blockId:t.id,text:n})),o()},defaultValue:t.text}),j&&Object(F.jsx)(ae,{query:k,onlyPages:!0,useLinks:!1,onResultClick:function(e,n){n.preventDefault();var c=e.text,r=d.current.value,a=d.current.selectionStart,i=A(r,a),l=r.substring(0,i.startBracketIndex+2)+c+r.substring(i.endBracketIndex);d.current.value=l,h(!1),I(null),s(G({blockId:t.id,text:l}))}})]})},le=n(42),oe=n(43),se=n.n(oe),de=Object(h.b)({name:"links",initialState:{to:{efgh:["mnop"]},from:{mnop:["efgh"]}},reducers:{setLinksState:function(e,t){var n=t.payload;if(n&&"to"in n&&"from"in n)return n},setLinks:function(e,t){var n=t.payload,c=n.sourceBlockId,r=n.linkedBlockIds;if(c&&r&&r.length){var a;if(c in e.from){if(JSON.stringify(e.from[c].sort())===JSON.stringify(r.sort()))return;var i=e.from[c].filter((function(e){return!r.includes(e)}));i.length&&i.map((function(t){return e.to[t]=e.to[t].filter((function(e){return c!==e})),!0})),a=r.filter((function(t){return!e.from[c].includes(t)}))}else a=r;a.length&&a.map((function(t){return t in e.to||(e.to[t]=[]),e.to[t].push(c),!0})),e.from[c]=r}},removeBlockLinks:function(e,t){var n=t.payload.blockId,c=e.from[n];de.caseReducers.setLinks(e,{payload:{sourceBlockId:n,linkedBlockIds:[]}}),c&&c.map((function(t){return e.to[t]=e.to[t].filter((function(e){return e!==n})),!0})),delete e.from[n]}}}),ue=de.actions,be=ue.setLinksState,fe=ue.setLinks,je=ue.removeBlockLinks,he=de.reducer,pe=function(e){var t=e.block,n=e.isTitle,c=e.onEdit,a=Object(l.b)(),i=Object(l.c)((function(e){return e.blocks})),o=Object(l.c)((function(e){return e.links.from})),s=function(e){var n=new Set,c=se()(e,/\[\[([^[\]]*)\]\]/g,(function(e,t){var c=u(e);return n.add(c.id),Object(F.jsx)(X,{blockId:c.id,children:c.text},"".concat(e,"-").concat(t))})),r=Array.from(n),i=t.id in o;return r.length&&(i&&d(new Set(r),new Set(o[t.id]))||a(fe({sourceBlockId:t.id,linkedBlockIds:r}))),c},d=function(e,t){if(e.size!==t.size)return!1;var n,c=Object(Y.a)(e);try{for(c.s();!(n=c.n()).done;){var r=n.value;if(!t.has(r))return!1}}catch(a){c.e(a)}finally{c.f()}return!0},u=function(e){var t=Object.values(i).filter((function(e){return!e.parentId})).find((function(t){return t.text===e}));if(t)return t;var n=g({text:e},i);return a(K(n)),n};return Object(F.jsx)("span",{className:"block-text".concat(n?" block-text--title":""),onClick:c,children:function(){var e=t.text;return s(e).map((function(e){if("string"===typeof e){var t=Object(le.a)(e);return r.a.cloneElement(t,{key:e})}return e}))}()})},xe=function(e){var t=e.block,n=e.isMain,r=e.isTitle,a=Object(l.c)((function(e){return e.editor.focusedBlock})),i=Object(c.useState)(a.isMain===n&&a.blockId===t.id),o=Object(u.a)(i,2),s=o[0],d=o[1],b=Object(c.useState)({offsetX:null,offsetY:null,width:null}),f=Object(u.a)(b,2),j=f[0],h=f[1];return a.blockId&&a.blockId===t.id&&a.isMain===n&&a.caretPos&&!s&&d(!0),Object(F.jsx)("div",{className:"block",children:s?Object(F.jsx)(ie,{block:t,isMain:n,isTitle:r,cursorCaret:j,setCursorCaret:h,onRender:function(e){d(!1)}}):Object(F.jsx)(pe,{block:t,isTitle:r,onEdit:function(e){if(!t.dailyNote){var n=e.clientX,c=e.clientY,r=n-e.currentTarget.offsetLeft,a=c-e.currentTarget.offsetTop,i=e.currentTarget.offsetWidth;h({offsetX:r,offsetY:a,width:i}),d(!0)}}})})},ve=function(e){var t=e.block,n=Object(l.c)((function(e){return e.blocks}));return Object(F.jsx)("div",{className:"breadcrumbs text-muted",children:function e(t){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)return c.reverse();var r=n[t],a=Object(F.jsx)(X,{blockId:t,isPage:null===r.parentId,noStyling:!0,children:r.text},t);return e(r.parentId,c.concat(a))}(t.parentId)})},Oe=(n(87),function(e){var t=e.block,n=e.hasChildren,c=e.foldBlock,r=e.setFoldBlock;return Object(F.jsxs)("div",{className:"block-actions-container",children:[Object(F.jsxs)("span",{className:"block-actions block-actions--toggle".concat(n?"":" hidden"),children:[c&&Object(F.jsx)(S.a,{color:"white",onClick:function(){return r(!1)}}),!c&&Object(F.jsx)(B.a,{color:"white",onClick:function(){return r(!0)}})]}),Object(F.jsx)(X,{blockId:t.id,noStyling:!0,isPage:!1,children:Object(F.jsx)("div",{className:"block-actions block-actions--bullet".concat(c&&n?" fold":""),children:Object(F.jsx)("span",{children:"\u2022"})})})]})}),ke=function e(t){var n=t.blockId,r=t.isRoot,a=t.showBreadcrumbs,i=void 0!==a&&a,o=t.isMain,s=t.fold,d=void 0!==s&&s,b=Object(l.c)((function(e){return e.blocks}))[n],f=Object(c.useState)(d),j=Object(u.a)(f,2),h=j[0],p=j[1],x=Object(c.useState)(!1),v=Object(u.a)(x,2),O=v[0],k=v[1];if(Object(c.useEffect)((function(){p(d)}),[d]),!b)return Object(F.jsx)("h1",{className:"text-light",children:"Page not found"});var I=null===b.parentId,g=I&&r,m=b.childrenIds.map((function(t){return Object(F.jsx)(e,{isRoot:!1,isMain:o,blockId:t,fold:O},t)}));return Object(F.jsxs)("div",{className:"editor ".concat(r?"editor--root":"editor--child").concat(I?" editor--page":""),children:[(i||r&&!I)&&Object(F.jsx)(ve,{block:b}),Object(F.jsxs)("div",{className:"d-flex",children:[!g&&Object(F.jsx)(Oe,{block:b,foldBlock:h,setFoldBlock:p,hasChildren:m.length>0}),Object(F.jsx)(xe,{block:b,isTitle:g,isMain:o})]}),!h&&m.length>0&&Object(F.jsxs)("div",{className:"editor__children",children:[null!==b.parentId&&Object(F.jsx)("div",{className:"editor__children__thread-line",onClick:function(){return k(!O)}}),Object(F.jsx)("div",{className:"editor__children__container",children:m})]}),r&&Object(F.jsx)(D,{block:b,isMain:o},b.id)]})},Ie=n(108),ge=n(109),me=n(110),ye=(n(88),Object(h.b)({name:"navbar",initialState:{searchQuery:""},reducers:{setNavbarState:function(e,t){var n=t.payload;if(n&&"searchQuery"in n)return n},updateSearchQuery:function(e,t){var n=t.payload.query;e.searchQuery=n}}})),Ne=ye.actions,we=Ne.setNavbarState,Be=Ne.updateSearchQuery,Se=(Ne.removeShortcut,ye.reducer),Ce=Object(h.b)({name:"filePane",initialState:{favoriteBlockIds:["abcd","efgh"]},reducers:{setFilePaneState:function(e,t){var n=t.payload;if(n&&"favoriteBlockIds"in n)return n},toggleShortcut:function(e,t){var n=t.payload.blockId;e.favoriteBlockIds.indexOf(n)>-1?e.favoriteBlockIds=e.favoriteBlockIds.filter((function(e){return n!==e})):e.favoriteBlockIds.push(n)},removeShortcut:function(e,t){var n=t.payload.blockId;e.favoriteBlockIds=e.favoriteBlockIds.filter((function(e){return e!==n}))}}}),Pe=Ce.actions,Me=Pe.setFilePaneState,Re=Pe.toggleShortcut,Te=Pe.removeShortcut,_e=Ce.reducer,Fe=function(e){var t,n=e.blockId,c=Object(l.b)(),r=Object(l.c)((function(e){return e.navbar.searchQuery})),a=Object(l.c)((function(e){return e.blocks})),i=Object(l.c)((function(e){return e.filePane.favoriteBlockIds})),o=Object(d.f)(),s=function e(t){return t.parentId?e(a[t.parentId]):t.id};if(n){var u=a[n];if(u){var b=s(u);t=i.includes(b)}}var f;void 0!==t&&(f=t?Object(F.jsx)(Ie.a,{color:"white"}):Object(F.jsx)(ge.a,{color:"white"}));var j=function(e){c(Be({query:""}))};return Object(F.jsxs)("div",{className:"navbar",children:[Object(F.jsxs)("div",{className:"search-container",children:[Object(F.jsxs)("div",{className:"input-group",children:[Object(F.jsx)("div",{className:"input-group-prepend",children:Object(F.jsx)("span",{className:"input-group-text bg-dark text-dark border-secondary",children:Object(F.jsx)(me.a,{color:"white"})})}),Object(F.jsx)("input",{type:"text",className:"form-control bg-dark text-light border-secondary",placeholder:"Find or Create Page",onChange:function(e){return c(Be({query:e.target.value}))},value:r})]}),Object(F.jsx)(ae,{query:r,useLinks:!0,onResultClick:j,allowCreation:!0,onCreateClick:function(){var e=g({text:r},a);c(K(e)),j(),o.push("/page/".concat(e.id))}})]}),void 0!==f&&Object(F.jsx)("button",{className:"btn btn--toggle-favorite",onClick:function(e){var t=s(a[n]);c(Re({blockId:t}))},children:f})]})},Xe=n(27),De=n.n(Xe);n(89);x.a.extend(De.a);var qe=function(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e.blocks})),c=Object.values(n).filter((function(e){return!!e.dailyNote})).sort((function(e,t){return e.dailyNote.localeCompare(t.dailyNote)})).reverse(),r=x()(),a=r.format(k),i=c.find((function(e){return e.text===a}));i||(i=g({text:a,dailyNote:r.format(I)},n),t(K(i)));var o=c.map((function(e){return Object(F.jsx)(ke,{blockId:e.id,isMain:!0,isRoot:!0},e.id)}));return Object(F.jsx)("div",{className:"daily-notes",children:o})},Le=n(29),Ee=n(111),Ye=n(112),Ae=n(113),He=n(114),ze=n(44),Ve=n(45),We=n.n(Ve),Ke=(n(100),function(e){var t=new We.a;e.map((function(e){var n=e.content,c=e.fileName;return t.file(c||"free-roam.json",JSON.stringify(n)),!0})),t.generateAsync({type:"blob"}).then((function(e){Object(ze.saveAs)(e,"Free-Roam-Export-".concat(Date.now()))}))}),Je=function(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e}));return Object(F.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(F.jsx)("label",{className:"load-button-input mr-3",children:Object(F.jsx)("input",{type:"file",className:"btn btn-secondary",accept:".json",onChange:function(e){e.preventDefault();var n=new FileReader;n.onload=function(e){var n=JSON.parse(e.target.result);"blocks"in n&&t(W(n.blocks)),"editor"in n&&t(ne(n.editor)),"filePane"in n&&t(Me(n.filePane)),"links"in n&&t(be(n.links)),"navbar"in n&&t(we(n.navbar)),"viewPane"in n&&t(M(n.viewPane))},n.readAsText(e.target.files[0])}})}),Object(F.jsx)("button",{className:"btn btn-secondary",onClick:function(){return Ke([{content:n,fileName:"free-roam.json"}])},children:"Save"})]})},Qe=r.a.forwardRef((function(e,t){var n=e.indeterminate,c=Object(j.a)(e,["indeterminate"]),a=r.a.useRef(),i=t||a;return r.a.useEffect((function(){i.current.indeterminate=n}),[i,n]),Object(F.jsx)(F.Fragment,{children:Object(F.jsx)("input",Object(f.a)({type:"checkbox",ref:i},c))})})),Ge=function(e){var t=e.columns,n=e.data,c=Object(l.b)(),r=Object(l.c)((function(e){return e.blocks})),a=Object(l.c)((function(e){return e.links.to})),i=function(e){e.length&&e.map((function(e){return e.original.blockId})).map((function(e){var t=r[e];return w(r[e],r).map((function(e){return c(T({type:"all",blockId:e})),(a[e]||[]).map((function(e){var n=r[e],a=new RegExp("\\[\\[(".concat(t.text,")\\]\\]"),"g"),i=n.text.replace(a,"$1");return c(G({blockId:e,text:i})),!0})),c(je({blockId:e})),!0})),c(Te({blockId:e})),c(Q({blockId:e})),!0}))},o=Object(Le.useTable)({columns:t,data:n},Le.useSortBy,Le.useRowSelect,(function(e){e.visibleColumns.push((function(e){return[{id:"selection",Header:function(e){var t=e.getToggleAllRowsSelectedProps;return Object(F.jsx)("div",{children:Object(F.jsx)(Qe,Object(f.a)({},t()))})},Cell:function(e){var t=e.row;return Object(F.jsx)("div",{children:Object(F.jsx)(Qe,Object(f.a)({},t.getToggleRowSelectedProps()))})}}].concat(Object(b.a)(e))}))})),s=o.getTableProps,d=o.getTableBodyProps,u=o.headerGroups,j=o.rows,h=o.prepareRow,p=o.selectedFlatRows,x=o.state.selectedRowIds;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("div",{className:"all-pages__toolbar",children:[Object(F.jsx)(Ee.a,{onClick:function(){return i(p)},className:"mr-3 all-pages__button".concat(Object.keys(x).length?" active":"")}),Object(F.jsx)(Ye.a,{onClick:function(){return function(e){if(e.length){var t=e.map((function(e){return e.original.blockId})).map((function(e){var t=r[e];return{content:N(t,r),fileName:"".concat(t.text,".json")}}));Ke(t)}}(p)},className:"all-pages__button".concat(Object.keys(x).length?" active":"")}),Object(F.jsx)("div",{className:"flex-grow-1"})]}),Object(F.jsxs)("table",Object(f.a)(Object(f.a)({className:"table table-dark"},s()),{},{children:[Object(F.jsx)("thead",{className:"thead-dark",children:u.map((function(e){return Object(F.jsx)("tr",Object(f.a)(Object(f.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(F.jsxs)("th",Object(f.a)(Object(f.a)({scope:"col"},e.getHeaderProps([{className:e.className},e.getSortByToggleProps()])),{},{children:[e.render("Header"),Object(F.jsx)("span",{children:e.isSorted?e.isSortedDesc?Object(F.jsx)(Ae.a,{color:"white"}):Object(F.jsx)(He.a,{color:"white"}):""})]}))}))}))}))}),Object(F.jsx)("tbody",Object(f.a)(Object(f.a)({},d()),{},{children:j.map((function(e,t){return h(e),Object(F.jsx)("tr",Object(f.a)(Object(f.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(F.jsx)("td",Object(f.a)(Object(f.a)({},e.getCellProps([{className:e.column.className}])),{},{children:e.render("Cell")}))}))}))}))}))]}))]})};n(101);x.a.extend(De.a);var Ue=function(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e.blocks})),a=Object(l.c)((function(e){return e.links.to})),i=Object(c.useCallback)((function(e,n){t(R({type:"references",blockId:e}))}),[t]),o=r.a.useMemo((function(){return[{Header:"Title",className:"font-weight-bold",accessor:function(e){return Object(F.jsx)(X,{blockId:e.blockId,children:e.text},e.blockId)},sortType:function(e,t,n,c){return e.original.text.localeCompare(t.original.text)}},{Header:"Mentions",accessor:"mentions",className:"text-center",Cell:function(e){var t=e.row,n=e.value;return Object(F.jsx)("div",{className:"mentions-bubble",onClick:i.bind(null,t.original.blockId),children:Object(F.jsx)("span",{children:n.length})})},sortType:function(e,t,n,c){return e.original.mentions.length-t.original.mentions.length}},{Header:"Updated",accessor:"updated",className:"text-right",Cell:function(e){var t=e.value;return t?x()(t).format(k):null}},{Header:"Created",accessor:"created",className:"text-right",Cell:function(e){var t=e.value;return t?x()(t).format(k):null}}]}),[i]),s=r.a.useMemo((function(){return function(e,t){return Object.values(e).filter((function(e){return!e.parentId})).map((function(e){return{text:e.text,blockId:e.id,created:e.created,updated:e.updated,mentions:t[e.id]||[]}}))}(n,a)}),[n,a]);return Object(F.jsx)("div",{className:"all-pages",children:Object(F.jsx)(Ge,{columns:o,data:s})})},Ze=function(e){return Object(F.jsx)("div",{className:"main",children:Object(F.jsxs)("div",{className:"stage",children:[Object(F.jsx)(d.b,{exact:!0,path:"/",children:Object(F.jsx)(d.a,{to:"/page/welcome"})}),Object(F.jsx)(d.b,{path:"/page/:blockId",render:function(e){var t=e.match;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Fe,{blockId:t.params.blockId}),Object(F.jsx)(ke,{blockId:t.params.blockId,isRoot:!0,isMain:!0})]})}}),Object(F.jsx)(d.b,{path:"/daily-notes",render:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Fe,{}),Object(F.jsx)(qe,{})]})}}),Object(F.jsx)(d.b,{path:"/all-pages",render:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Fe,{}),Object(F.jsx)(Ue,{})]})}})]})})},$e=n(115),et=n(116);n(102);var tt=function(e){var t=Object(l.c)((function(e){return e.blocks})),n=Object(l.c)((function(e){return e.filePane.favoriteBlockIds})).map((function(e){var n=t[e];return Object(F.jsx)(X,{blockId:e,className:"list-group-item list-group-item-action bg-dark text-light",children:n.text},e)}));return Object(F.jsxs)("div",{children:[Object(F.jsxs)("h5",{children:[Object(F.jsx)(Ie.a,{color:"white",width:"15px",style:{marginRight:"10px"}}),"Shortcuts"]}),Object(F.jsx)("div",{className:"list-group list-group-flush mt-3",children:n})]})},nt=function(e){return Object(F.jsxs)("div",{className:"pane file-pane",children:[Object(F.jsx)(s.b,{to:"/",children:Object(F.jsx)("h2",{className:"text-light text-center",children:"Free-roam"})}),Object(F.jsx)(Je,{}),Object(F.jsxs)("div",{className:"list-group list-group-flush mt-3",children:[Object(F.jsxs)(s.b,{to:"/daily-notes",className:"list-group-item list-group-item-action bg-dark text-light",children:[Object(F.jsx)($e.a,{color:"white"})," Daily Notes"]}),Object(F.jsxs)(s.b,{to:"/all-pages",className:"list-group-item list-group-item-action bg-dark text-light",children:[Object(F.jsx)(et.a,{color:"white"})," All Pages"]})]}),Object(F.jsx)("hr",{}),Object(F.jsx)(tt,{})]})},ct=n(117),rt=(n(103),function(e){var t=Object(l.c)((function(e){return e.blocks})),n=Object(l.c)((function(e){return e.links})),c=Object(l.c)((function(e){return e.viewPane.views})),r=Object(l.b)(),a=function(e,t,n){r(T({type:e,blockId:t}))},i=function(e,t){var n;switch(e){case"page":n="Outline of:";break;case"block":n="Block outline of:";break;case"references":n=Object(F.jsxs)("span",{children:["References to: ",Object(F.jsx)(X,{blockId:t.id,children:t.text})]});break;default:n="Outline of:"}return n},o=c.map((function(e){var c=e.type,l=e.blockId;if(!(l in t))return null;var o=t[l],s=n.to[o.id]||[];return Object(F.jsxs)("div",{className:"view-pane__section",children:[Object(F.jsxs)("div",{className:"d-flex align-items-center",children:[i(c,o),Object(F.jsx)("div",{className:"flex-grow-1"}),"page"===c&&Object(F.jsx)("button",{className:"btn btn-dark btn-sm px-1 py-0",onClick:function(){return r(R({type:"references",blockId:l}))},children:s.length}),Object(F.jsx)(ct.a,{className:"btn-close",onClick:a.bind(null,c,o.id)})]}),"references"===c?Object(F.jsx)(D,{block:o,isMain:!0}):Object(F.jsx)(ke,{blockId:o.id,isRoot:!0,isMain:!1})]},"".concat(c,"-").concat(o.id))}));return Object(F.jsx)("div",{className:"pane view-pane",children:o})}),at=function(){return Object(F.jsx)("div",{className:"App",children:Object(F.jsxs)(s.a,{children:[Object(F.jsx)(nt,{}),Object(F.jsx)(Ze,{}),Object(F.jsx)(rt,{})]})})},it={blocks:$,filePane:_e,viewPane:_,navbar:Se,links:he,editor:re},lt=Object(h.a)({reducer:it});n(104);window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue=""})),i.a.render(Object(F.jsx)(r.a.StrictMode,{children:Object(F.jsx)(l.a,{store:lt,children:Object(F.jsx)(at,{})})}),document.getElementById("root")),o()},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.1cc2963f.chunk.js.map